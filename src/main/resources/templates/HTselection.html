<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <base th:href="${#request.getContextPath()}+'/'">
    <title>后台管理系统</title>
    <meta http-equiv="pragma" content="no-cache"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" type="image/x-icon" href="images/favicon.ico">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <!--表格css-->
    <link rel="stylesheet" href="css/tables/datatables.min.css">
    <link rel="stylesheet" href="css/tables/datatables-http.min.css">
    <link rel="stylesheet" href="css/tables/jsgrid/jsgrid.css">
    <link rel="stylesheet" href="css/tables/jsgrid/theme.css">
    <link rel="stylesheet" href="css/tables/buttons.dataTables.min.css">
    <link rel="stylesheet" href="css/tables/jsgrid/demos.css">
    <link rel="stylesheet" href="css/tables/jsgrid/jsgridui.css">

    <link rel="stylesheet" type="text/css" href="css/materialdesignicons.min.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="js/bootstrap-multitabs/multitabs.min.css">
    <link type="text/css" rel="stylesheet" href="js/jquery-tagsinput/jquery.tagsinput.min.css">
    <link type="text/css" rel="stylesheet" href="js/webuploader/webuploader.css">
    <link type="text/css" rel="stylesheet" href="js/magnific-popup/magnific-popup.min.css">
    <link rel="stylesheet" type="text/css" href="css/animate.min.css">
    <link rel="stylesheet" type="text/css" href="css/style.min.css">

    <link rel="stylesheet" type="text/css" href="js/bootstrap-select/bootstrap-select.min.css">
    <!--日程插件-->
    <link rel="stylesheet" type="text/css" href="js/fullcalendar/core/main.min.css">
    <link rel="stylesheet" type="text/css" href='js/fullcalendar/daygrid/main.min.css' />
    <link rel="stylesheet" type="text/css" href='js/fullcalendar/timegrid/main.min.css' />
    <link rel="stylesheet" type="text/css" href='js/fullcalendar/list/main.min.css' />
    <!--时间选择器css-->
    <link rel="stylesheet" type="text/css" href="js/bootstrap-datetimepicker/bootstrap-datetimepicker.min.css">
    <!--日期选择器css-->
    <link rel="stylesheet" type="text/css" href="js/bootstrap-datepicker/bootstrap-datepicker3.min.css">
    <link rel="stylesheet" type="text/css" href="css/page.css">

    <style>
        td.fc-day.fc-past {
            background-color: #FaFaFa;
        }
        .small-f1{
            font-size: 12px;
            color:#6a6a6a;
        }
        .fadeMask{
            width:100%;
            height:100%;
            position: fixed;
            left: 0;
            top: 0;
            background-color: #0a0a0a48;
        }


    </style>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="col-lg-12">
            <div class="card">
                <div class="card-body">
                    <div class="card-search mb-2-5">
                        <form class="search-form" method="post" role="form" action="toHt/toselection">
                            <input type="hidden" id="pages" name="pages" th:value="${pageobj.currentPage}"/>
                            <input type="hidden" id="counts" name="counts" th:value="${pageobj.pageCount}"/>
                            <input type="hidden" id="jstype" name="jstype" th:value="${session.umsg.jstype}"/>
                            <input type="hidden" id="ztype" name="ztype" th:value="${pageobj.othersql2}"/>
                            <input type="hidden" id="fhlx" name="fhlx" th:value="${fhlx}"/>
                            <!--text input-->
                            <div class="row g-5">
                                <div class="col-auto" >
                                    <div class="row">
                                        <label class="col-auto col-form-label" style="padding-right:0;padding-left:10px;">发起方</label>
                                        <div class="col-auto">
                                            <select id="fzt" name="fzt" class="form-control selectpicker">
                                                <option value="" selected></option>
                                                <option value="B"  th:selected="${pageobj.othersql7=='B'?true:false}">授课方</option>
                                                <option value="C"  th:selected="${pageobj.othersql7=='C'?true:false}">选课方</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <!--<div class="col-auto">
                                    <div class="row">
                                        <label class="col-auto col-form-label" style="padding-right:0;padding-left:10px;">名称</label>
                                        <div class="col-auto">
                                            <input type="text" class="form-control" id="name" name="name" th:value="${pageobj.othersql}" placeholder="请输入名称"/>
                                        </div>
                                    </div>
                                </div>-->
                                <div class="col-auto" th:style="${session.umsg.jstype=='B'?'display: none':''}">
                                    <div class="row">
                                        <label class="col-auto col-form-label" style="padding-right:0;padding-left:10px;">授课方名称</label>
                                        <div class="col-auto">
                                            <select id="skid" name="skid"  class="form-control selectpicker" data-live-search="true">
                                                <option value="" selected>请选择</option>
                                                <th:block th:each="item,stat:${smdlist}">
                                                    <option th:value="${item.smd001}"  th:selected="${pageobj.othersql5==#strings.toString(item.smd001)?true:false}">[[${item.smd003}]]</option>
                                                </th:block>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-auto" th:style="${session.umsg.jstype=='C'||(fhlx!=null&&(#strings.indexOf(fhlx,'LE')>=0||#strings.indexOf(fhlx,'XK')>=0))?'display: none':''}">
                                    <div class="row">
                                        <label class="col-auto col-form-label" style="padding-right:0;padding-left:10px;">层级名称</label>
                                        <div class="col-auto">
                                            <select id="flid" name="flid" class="form-control selectpicker">
                                                <option value="" selected></option>
                                                <th:block th:each="item,stat:${yhalist}">
                                                    <option th:value="${item.yha001}"  th:selected="${pageobj.othersql1==#strings.toString(item.yha001)?true:false}">[[${item.yha002}]]</option>
                                                </th:block>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-auto" th:style="${session.umsg.jstype=='C'||(fhlx!=null&&#strings.indexOf(fhlx,'XK')>=0)?'display: none':''}">
                                    <div class="row">
                                        <label class="col-auto col-form-label" style="padding-right:0;padding-left:10px;">选课方名称</label>
                                        <div class="col-auto">
                                            <select id="xkid" name="xkid"  class="form-control selectpicker" data-live-search="true">
                                                <option value="" selected>请选择</option>
                                                <th:block th:each="item,stat:${yhblist}">
                                                    <option th:value="${item.yhb001}"  th:selected="${pageobj.othersql6==#strings.toString(item.yhb001)?true:false}">[[${item.yhb004}]]</option>
                                                </th:block>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <!--button-->
                                <div class="col-auto" th:style="${session.umsg.jstype=='B'&&fhlx!=null&&#strings.indexOf(fhlx,'XK')>=0?'display: none':''}">
                                    <button type="submit" class="btn btn-primary me-1">搜索</button>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div id="wrapp" >
                        <div class="jsgrid table-responsive" data-parent="#accordion">
                            <input type="file" id="file" name="file" style="display: none" onchange="daoru(this)"/>
                            <table class="table table-striped table-bordered dt-responsive nowrap" style="width:100%;" id="selectionexm" >
                                <thead>
                                <tr>
                                    <th style="max-width:30px;">序号</th>
                                    <th>选课方名称</th>
                                    <th>授课方名称</th>
                                    <th>课程名称</th>
                                    <th>老师名称</th>
                                    <th>授课地点</th>
                                    <th>授课日期</th>
                                    <th>授课结束日期</th>
                                    <th>状态</th>
                                    <th>发起方</th>
                                    <th style="max-width:80px;">操作</th>
                                </tr>
                                </thead>
                                <tbody id="tablebody">
                                <tr th:each="item,stat:${pageobj.resultList}">
                                    <td th:text="${stat.index+1}"></td>
                                    <td th:text="${item.yhb!=null?item.yhb.yhb004:''}"></td>
                                    <td th:text="${item.smd!=null?item.smd.smd003:''}"></td>
                                    <td th:text="${item.hba.hba002}"></td>
                                    <td th:text="${item.yhc!=null?item.yhc.yhc003:''}"></td>
                                    <td th:text="${item.yhe009}"></td>
                                    <td th:text="${#dates.format(item.yhe008,'yyyy-MM-dd')}"></td>
                                    <td th:text="${#dates.format(item.yhe020,'yyyy-MM-dd')}"></td>
                                    <td th:style="${item.yhe007=='M'||item.yhe007=='N'||item.yhe007=='A'||item.yhe007=='B'?'color:#A46BFF':
                                                   (item.yhe007=='C'||item.yhe007=='D'?'color:#FFAA00;':(item.yhe007=='G'||item.yhe007=='H'?'color:#6ABF47;':
                                                   (item.yhe007=='O'||item.yhe007=='P'?'color:#787878;':
                                                   (item.yhe007=='E'?'color:#36AFF5;':'color:#5776F2;'))))}"
                                        th:text="${item.yhe007=='A'||item.yhe007=='B'?'预约待确认':
                                                  (item.yhe007=='C'||item.yhe007=='D'?'预约退回': (item.yhe007=='G'||item.yhe007=='H'?'预约成功':
                                                  (item.yhe007=='M'||item.yhe007=='N'?'取消待确认':(item.yhe007=='O'||item.yhe007=='P'?'确认取消':
                                                  (item.yhe007=='E'?'授课结束':(item.yhe007=='R'?'授课方已评价':(item.yhe007=='Q'?'选课方已评价':'完结未传')))))))}"></td>
                                    <td th:text="${item.yhe007=='B'?'授课方':'选课方'}"></td>
                                    <td>
                                        <div class="btn-group btn-group-sm">
                                            <a href="javascript:void(0);" th:onclick="toxq([[${item.toString()}]],[[${item.yhe008}]],[[${item.hba.toString()}]],[[${item.yhb.toString()}]],[[${item.smd.toString()}]],[[${item.yhflist.toString()}]],[[${item.yhflistA.toString()}]],[[${item.yhflistB.toString()}]],[[${item.yhflistC.toString()}]])" class="btn btn-table" data-bs-toggle="modal" data-bs-target="#xqmode">详情</a>
                                            <th:block th:if="${item.yhe007=='C'||item.yhe007=='D'||item.yhe007=='S'||item.yhe007=='T'}">
                                                <a href="javascript:void(0);" th:onclick="tobh([[${item.toString()}]],'A')" class="btn btn-table" data-bs-toggle="modal" data-bs-target="#xqmode">驳回理由</a>
                                            </th:block>
                                            <th:block th:if="${item.yhe007=='M'||item.yhe007=='N'}">
                                                <a href="javascript:void(0);" th:onclick="tobh([[${item.toString()}]],'B')" class="btn btn-table" data-bs-toggle="modal" data-bs-target="#xqmode">取消理由</a>
                                            </th:block>
                                            <th:block th:if="${session.umsg.jstype=='B'}">
                                                <th:block th:if="${item.yhe007=='B'}">
                                                    <a href="javascript:void(0);" th:onclick="edit([[${item.toString()}]],[[${item.hba.hba021}]],[[${item.yhb.yhb002}]],[[${item.yhe008}]],[[${item.yhflist.toString()}]])" class="btn btn-table" data-bs-toggle="modal" data-bs-target="#yymode">编辑</a>
                                                </th:block>
                                                <div class="ivu-divider-vertical"></div>
                                                <th:block th:if="${item.yhe007=='A'}">
                                                    <a class="btn btn-table" data-bs-toggle="modal" data-bs-target="#delmode"  th:onclick="xgzt([[${item.yhe001}]],[[${item.yhb.yhb004}]],[['G']])">接受</a>
                                                    <a class="btn btn-table" data-bs-toggle="modal" data-bs-target="#delmode"  th:onclick="xgzt([[${item.yhe001}]],[[${item.yhb.yhb004}]],[['C']])">退回</a>
                                                </th:block>
                                                <th:block th:if="${item.yhe007=='M'}">
                                                    <a class="btn btn-table" data-bs-toggle="modal" data-bs-target="#delmode"  th:onclick="xgzt([[${item.yhe001}]],[[${item.yhb.yhb004}]],[['O']])">确认取消</a>
                                                    <a class="btn btn-table" data-bs-toggle="modal" data-bs-target="#delmode"  th:onclick="xgzt([[${item.yhe001}]],[[${item.yhb.yhb004}]],[['T']])">驳回</a>
                                                </th:block>
                                                <th:block th:if="${item.yhe007=='B'||item.yhe007=='H'||item.yhe007=='K'}">
                                                    <a class="btn btn-table" data-bs-toggle="modal" data-bs-target="#delmode" th:onclick="xgzt([[${item.yhe001}]],[[${item.yhb.yhb004}]],[['N']],[[${item.yhe044!=''?item.yhe044:item.yhb.yhb006}]],[[${item.yhe045!=''?item.yhe045:item.yhb.yhb007}]])">取消预约</a>
                                                </th:block>
                                                <th:block th:if="${item.yhe007=='P'}">
                                                    <a class="btn btn-table" data-bs-toggle="modal" data-bs-target="#" th:onclick="del([[${item.yhe001}]],[[${item.yhb.yhb004}]])">删除</a>
                                                </th:block>
                                            </th:block>
                                            <th:block th:if="${session.umsg.jstype=='C'}">
                                                <th:block th:if="${item.yhe007=='A'}">
                                                    <a href="javascript:void(0);" th:onclick="edit([[${item.toString()}]],[[${item.hba.hba021}]],[[${item.yhb.yhb002}]],[[${item.yhb.yhb001}]],[[${item.yhe008}]],[[${item.yhflist.toString()}]])" class="btn btn-table" data-bs-toggle="modal" data-bs-target="#yymode">编辑</a>
                                                </th:block>
                                                <th:block th:if="${item.yhe007=='B'}">
                                                    <a class="btn btn-table" data-bs-toggle="modal" data-bs-target="#delmode"  th:onclick="xgzt([[${item.yhe001}]],[[${item.yhb.yhb004}]],[['H']])">接受</a>
                                                    <a class="btn btn-table" data-bs-toggle="modal" data-bs-target="#delmode"  th:onclick="xgzt([[${item.yhe001}]],[[${item.yhb.yhb004}]],[['D']])">退回</a>
                                                </th:block>
                                                <th:block th:if="${item.yhe007=='N'}">
                                                    <a class="btn btn-table" data-bs-toggle="modal" data-bs-target="#delmode"  th:onclick="xgzt([[${item.yhe001}]],[[${item.yhb.yhb004}]],[['P']])">确认取消</a>
                                                    <a class="btn btn-table" data-bs-toggle="modal" data-bs-target="#delmode"  th:onclick="xgzt([[${item.yhe001}]],[[${item.yhb.yhb004}]],[['S']])">驳回</a>
                                                </th:block>
                                                <th:block th:if="${item.yhe007=='A'||item.yhe007=='G'||item.yhe007=='G'}">
                                                    <a class="btn btn-table" data-bs-toggle="modal" data-bs-target="#delmode" th:onclick="xgzt([[${item.yhe001}]],[[${item.yhb.yhb004}]],[['M']],[[${item.hba.hba016}]],[[${item.hba.hba017}]])">取消预约</a>
                                                </th:block>
                                                <th:block th:if="${item.yhe007=='O'}">
                                                    <a class="btn btn-table" data-bs-toggle="modal" data-bs-target="#" th:onclick="del([[${item.yhe001}]],[[${item.yhb.yhb004}]])">删除</a>
                                                </th:block>
                                            </th:block>
                                            <th:block th:if="${session.umsg.jstype!='A'}">
                                                <th:block th:if="${item.yhe007=='F'||item.yhe007=='Q'||item.yhe007=='R'}">
                                                    <a href="javascript:void(0);" th:onclick="topj([[${item.toString()}]],[[${item.yhe020}]],[[${item.yhflistA.toString()}]],[[${item.yhflistB.toString()}]],[[${item.yhflistC.toString()}]])" class="btn btn-table" data-bs-toggle="modal" data-bs-target="#pjmode">评价</a>
                                                </th:block>
                                            </th:block>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <ul class="pagination">
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- 详情模态框 -->
    <div class="modal fade" id="xqmode" tabindex="-1" aria-labelledby="exampleModalFullscreenLabel" aria-hidden="true" >
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-header">
                    <h6 class="modal-title" id="xqmodeLabel">查看详情</h6>
                    <button type="button" class="btn-close" style="margin-right: 20px;" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div>
                    <div class="modal-body" style="padding-bottom: 180px;background-color: #FFF;"></div>
                </div>

            </div>
        </div>
    </div>

    <!-- 编辑分类模态框 -->
    <div class="modal fade" id="pjmode" tabindex="-1" aria-labelledby="exampleModalFullscreenLabel"
         aria-hidden="true" style="height:100%;background-color: #FFF;">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-header">
                    <h6 class="modal-title" id="editmodeLabel2"><span id="ftype2"></span></h6>
                    <button type="button" onclick="pagerefalsh()" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="uploadForm2" enctype="multipart/form-data">
                    <input type="hidden" id="lx" th:value="${session.umsg.jstype}"/>
                    <input type="hidden" id="tname" value=""/>
                    <input type="hidden" id="zt" value=""/>
                    <input type="hidden" id="xkid1" value=""/>
                    <input type="hidden" id="delimg" name="delimg"/>
                    <input type="hidden" id="delid" name="delid"/>
                    <div class="modal-body" style="min-height:580px;">
                        <th:block th:if="${session.umsg.jstype=='C'}">
                            <div class="row ">
                                <div class="col-md-3">
                                    <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">实际服务人次</label>
                                    <div class="col-10 col-sm-8 col-md-6 col-lg-4">
                                        <input type="number" min="0" class="form-control col-xl-12 col-md-12 col-sm-12 col-12" id="p17" name="p17" placeholder="请输入实际服务人次"/>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-xl-6 col-md-9 col-sm-10 col-12" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:10px;">结束日期</label>
                                <div class="col-xl-5 col-md-8 col-sm-8 col-12">
                                    <input type="date" class="form-control col-xl-12 col-md-12 col-sm-12 col-12" id="p19" name="p19" placeholder="请输入授课结束日期"/>
                                </div>
                            </div>
                            <div class="row col-auto" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">内容科学性</label>
                                <div class="form-check">
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r11" name="p1" value="A" type="radio" checked>
                                        <label for="r11" class="form-check-label">强</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r12" name="p1" value="B" type="radio">
                                        <label for="r12" class="form-check-label">较强</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r13" name="p1" value="C" type="radio">
                                        <label for="r13" class="form-check-label">一般</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-auto" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">内容丰富性</label>
                                <div class="form-check">
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r21" name="p2" value="A" type="radio" checked>
                                        <label for="r21" class="form-check-label">很丰富</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r22" name="p2" value="B" type="radio">
                                        <label for="r22" class="form-check-label">较好</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r23" name="p2" value="C" type="radio">
                                        <label for="r23" class="form-check-label">一般</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-auto" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">内容与人的相应度</label>
                                <div class="form-check">
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r31" name="p3" value="A" type="radio" checked>
                                        <label for="r31" class="form-check-label">很相应</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r32" name="p3" value="B" type="radio">
                                        <label for="r32" class="form-check-label">参差不一</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r33" name="p3" value="C" type="radio">
                                        <label for="r33" class="form-check-label">不相应</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-auto" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">内容时长设置</label>
                                <div class="form-check">
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r41" name="p4" value="A" type="radio" checked>
                                        <label for="r41" class="form-check-label">合理</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r42" name="p4" value="B" type="radio">
                                        <label for="r42" class="form-check-label">偏短</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r43" name="p4" value="C" type="radio">
                                        <label for="r43" class="form-check-label">偏长</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-auto" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">课前准备</label>
                                <div class="form-check">
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r51" name="p5" value="A" type="radio" checked>
                                        <label for="r51" class="form-check-label">充分</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r52" name="p5" value="B" type="radio">
                                        <label for="r52" class="form-check-label">一般</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r53" name="p5" value="C" type="radio">
                                        <label for="r53" class="form-check-label">不充分</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-auto" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">讲师场控能力</label>
                                <div class="form-check">
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r61" name="p6" value="A" type="radio" checked>
                                        <label for="r61" class="form-check-label">很强</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r62" name="p6" value="B" type="radio">
                                        <label for="r62" class="form-check-label">一般</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r63" name="p6" value="C" type="radio">
                                        <label for="r63" class="form-check-label">较弱</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-auto" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">课堂互动</label>
                                <div class="form-check">
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r71" name="p7" value="A" type="radio" checked>
                                        <label for="r71" class="form-check-label">较多</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r72" name="p7" value="B" type="radio">
                                        <label for="r72" class="form-check-label">弱</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r73" name="p7" value="C" type="radio">
                                        <label for="r73" class="form-check-label">没有</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-auto" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">总体评价</label>
                                <div class="form-check">
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r81" name="p8" value="A" type="radio" checked>
                                        <label for="r81" class="form-check-label">非常满意</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r82" name="p8" value="B" type="radio">
                                        <label for="r82" class="form-check-label">满意</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r83" name="p8" value="C" type="radio">
                                        <label for="r83" class="form-check-label">一般</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r84" name="p8" value="D" type="radio">
                                        <label for="r84" class="form-check-label">不满意</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row ">
                                <div class="col-md-3">
                                    <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">其他意见或建议</label>
                                    <div class="col-10 col-sm-8 col-md-6 col-lg-4">
                                        <textarea class="form-control" style="resize: none;" rows="3" id="p9" name="p9"></textarea>
                                    </div>
                                </div>
                            </div>
                        </th:block>
                        <th:block th:if="${session.umsg.jstype=='B'}">
                            <div class="row ">
                                <div class="col-md-3">
                                    <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">实际服务人次</label>
                                    <div class="col-10 col-sm-8 col-md-6 col-lg-4">
                                        <input type="number" min="0" class="form-control col-xl-12 col-md-12 col-sm-12 col-12" id="p18" name="p18" placeholder="请输入实际服务人次"/>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-auto" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">实际与预计人数差别</label>
                                <div class="form-check">
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r101" name="p10" value="A" type="radio" checked>
                                        <label for="r101" class="form-check-label">较一致</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r102" name="p10" value="B" type="radio">
                                        <label for="r102" class="form-check-label">差不多</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r103" name="p10" value="C" type="radio">
                                        <label for="r103" class="form-check-label">出入大</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-auto" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">年龄层次的一致性</label>
                                <div class="form-check">
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r111" name="p11" value="A" type="radio" checked>
                                        <label for="r111" class="form-check-label">较一致</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r112" name="p11" value="B" type="radio">
                                        <label for="r112" class="form-check-label">一般</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r113" name="p11" value="C" type="radio">
                                        <label for="r113" class="form-check-label">差别大 </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-auto" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">迟到早退现象</label>
                                <div class="form-check">
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r121" name="p12" value="A" type="radio" checked>
                                        <label for="r121" class="form-check-label">没有</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r122" name="p12" value="B" type="radio">
                                        <label for="r122" class="form-check-label">少部分</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r123" name="p12" value="C" type="radio">
                                        <label for="r123" class="form-check-label">较普遍</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-auto" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">场地准备</label>
                                <div class="form-check">
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r131" name="p13" value="A" type="radio" checked>
                                        <label for="r131" class="form-check-label">充分</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r132" name="p13" value="B" type="radio">
                                        <label for="r132" class="form-check-label">一般</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r133" name="p13" value="C" type="radio">
                                        <label for="r133" class="form-check-label">不充分</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-auto" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">细节配合</label>
                                <div class="form-check">
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r141" name="p14" value="A" type="radio" checked>
                                        <label for="r141" class="form-check-label">很强</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r142" name="p14" value="B" type="radio">
                                        <label for="r142" class="form-check-label">一般</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r143" name="p14" value="C" type="radio">
                                        <label for="r143" class="form-check-label">较弱</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-auto" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">总体评价</label>
                                <div class="form-check">
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r151" name="p15" value="A" type="radio" checked>
                                        <label for="r151" class="form-check-label">非常好</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r152" name="p15" value="B" type="radio">
                                        <label for="r152" class="form-check-label">好</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r153" name="p15" value="C" type="radio">
                                        <label for="r153" class="form-check-label">一般</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input  class="form-check-input" id="r154" name="p15" value="D" type="radio">
                                        <label for="r154" class="form-check-label">不太好</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row ">
                                <div class="col-md-3">
                                    <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">其他意见或建议</label>
                                    <div class="col-10 col-sm-8 col-md-6 col-lg-4">
                                        <textarea class="form-control" style="resize: none;" rows="3" id="p16" name="p16"></textarea>
                                    </div>
                                </div>
                            </div>
                        </th:block>
                        <div class="row">
                            <div class="mb-3 col-md-12">
                                <input id="ww2" name="ww2" type="hidden">
                                <label for="w2" class="form-label">签到表</label>
                                <input class="form-control" type="file" id="w2" onchange="showpdtpgs1('w2','#p2','A')" multiple>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-10  col-sm-10"><div class="form-group">
                                <div id="p2" style="display: flex;justify-content: start;align-items: center;flex-flow: row wrap;"></div>
                            </div></div>
                        </div>
                        <div class="row">
                            <div class="mb-3 col-md-12">
                                <input id="ww3" name="ww3" type="hidden">
                                <label for="w3" class="form-label">服务照片</label>
                                <input class="form-control" type="file" id="w3" onchange="showpdtpgs1('w3','#p3','B')" multiple>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-10  col-sm-10"><div class="form-group">
                                <div id="p3" style="display: flex;justify-content: start;align-items: center;flex-flow: row wrap;"></div>
                            </div></div>
                        </div>
                        <div class="row">
                            <div class="mb-3 col-md-12">
                                <input id="ww4" name="ww4" type="hidden">
                                <label for="w3" class="form-label">服务视频</label>
                                <input class="form-control" type="file" id="w4" onchange="showpdtpgs1('w4','#p4','C')" multiple>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-10  col-sm-10"><div class="form-group">
                                <div id="p4" style="display: flex;justify-content: start;align-items: center;flex-flow: row wrap;"></div>
                            </div></div>
                        </div>
                    </div>
                    <div class="modal-footer" style="height:100px;">
                        <button type="submit" class="btn btn-primary" id="edit-four2">提交</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- 编辑分类模态框 -->
    <div class="modal fade" id="yymode" tabindex="-1" aria-labelledby="exampleModalFullscreenLabel"
         aria-hidden="true" style="height:100%;background-color: #FFF;">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-header">
                    <h6 class="modal-title" id="editmodeLabel1"><span id="ftype1"></span></h6>
                    <button type="button" onclick="pagerefalsh()" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="uploadForm1" enctype="multipart/form-data">
                    <input type="hidden" id="fid" value=""/>
                    <input type="hidden" id="fname" value=""/>
                    <div class="modal-body" style="min-height:580px;">
                        <div class="row col-auto" style="margin-top: 20px">
                            <th:block th:if="${session.umsg.jstype=='C'}">
                                <input type="hidden" id="t3" th:value="${pageobj.othersql6}"/>
                            </th:block>
                            <th:block th:if="${session.umsg.jstype=='B'}">
                                <div class="col-lg-4 col-md-6 col-sm-8">
                                    <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">层级</label>
                                    <div class="col-10 col-sm-8 col-md-6 col-lg-4">
                                        <select id="t9" name="t9"  class="form-control selectpicker" data-live-search="true">
                                            <option value="" selected></option>
                                            <th:block th:each="item,stat:${yhalist}">
                                                <option th:value="${item.yha001}">[[${item.yha002}]]</option>
                                            </th:block>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-6 col-sm-8">
                                    <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">选课方</label>
                                    <div class="col-10 col-sm-8 col-md-6 col-lg-4">
                                        <select id="t3" name="t3"  class="form-control selectpicker" data-live-search="true">
                                            <option value="" selected></option>
                                        </select>
                                    </div>
                                </div>
                            </th:block>

                        </div>
                        <div class="row col-auto">
                            <div class="col-lg-2 col-md-3 col-sm-4">
                                <label class="col-auto col-form-label" style="padding-right:1px;padding-left:10px;">课程分类</label>
                                <div class="form-controls">
                                    <select id="t1" name="t1"  class="form-control form-select">
                                        <option value=""></option>
                                        <th:block th:each="item,stat:${hbblist}">
                                            <option th:value="${item.hbb001}" >[[${item.hbb002}]]</option>
                                        </th:block>
                                    </select>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-6 col-sm-8">
                                <label class="col-auto col-form-label" style="padding-right:1px;padding-left:10px;">课程</label>
                                <div class="form-controls">
                                    <select id="t4" name="t4" class="form-control selectpicker"  data-live-search="true">
                                        <option value=""></option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row col-auto">
                            <div class="col-lg-4 col-md-6 col-sm-8">
                                <label class="col-auto col-form-label" style="padding-right:1px;padding-left:10px;">授课日期</label>
                                <input type="text" class="form-control col-auto" disabled="false" id="t8" name="t8" />
                            </div>
                        </div>
                        <div class="row col-auto" th:style="${session.umsg.jstype=='C'?'margin-top: 20px;display: none':'margin-top: 20px;'}">
                            <div class="col-lg-4 col-md-6 col-sm-8">
                                <label class="col-auto col-form-label" style="padding-right:1px;padding-left:10px;">选择老师</label>
                                <select id="t11" name="t11" class="form-control selectpicker col-xl-12 col-md-12 col-sm-12 col-12" data-live-search="true">
                                    <option value=""></option>
                                </select>
                            </div>
                        </div>
                        <div class="row col-auto">
                            <div class="col-lg-4 col-md-6 col-sm-8" th:style="${session.umsg.jstype=='C'?'':'display: none'}">
                                <label class="col-auto col-form-label" style="padding-right:1px;padding-left:10px;">授课地点</label>
                                <div class="col-xl-8 col-md-7 col-sm-9">
                                    <input type="text" class="form-control col-auto" id="t2" name="t2" placeholder="请输入授课地点"/>
                                </div>
                            </div>
                            <div class="col-lg-2 col-md-3 col-sm-4">
                                <label class="col-auto col-form-label" style="padding-right:1px;padding-left:10px;">预计活动人数</label>
                                <input type="number" class="form-control col-auto" id="t14" name="t14" placeholder="请输入预计活动人数"/>
                            </div>
                        </div>
                        <div class="row col-xl-6 col-md-9 col-sm-10 col-12"  th:style="${session.umsg.jstype=='B'?'margin-top: 20px;':'display:none;'}">
                            <label class="col-auto col-form-label" style="padding-right:6px;padding-left:10px;">志愿者人数</label>
                            <div class="col-xl-5 col-md-8 col-sm-8 col-12">
                                <input type="number" class="form-control col-xl-12 col-md-12 col-sm-12 col-12" id="t6" name="t6" placeholder="请输入志愿者人数"/>
                            </div>
                        </div>
                        <div class="row col-auto" th:style="${session.umsg.jstype=='C'?'':'display: none'}">
                            <div class="col-lg-4 col-md-6 col-sm-8">
                                <label class="col-auto col-form-label" style="padding-right:1px;padding-left:10px;">联系人</label>
                                <input type="text" class="form-control col-auto" id="t44" name="t44" placeholder="请输入联系人"/>
                            </div>
                            <div class="col-lg-2 col-md-3 col-sm-4">
                                <label class="col-auto col-form-label" style="padding-right:1px;padding-left:10px;">联系电话</label>
                                <input type="text" class="form-control col-auto" id="t45" name="t45" placeholder="请输入联系电话"/>
                            </div>
                        </div>
                        <div class="row col-auto" th:style="${session.umsg.jstype=='C'?'':'display: none'}">
                            <div class="col-lg-4 col-md-6 col-sm-8">
                                <label class="col-auto col-form-label" style="padding-right:1px;padding-left:10px;">预约日期备注</label>
                                <input type="text" class="form-control col-auto" id="t42" name="t42" placeholder="请输入预约日期备注"/>
                            </div>
                        </div>
                        <div class="row col-auto" th:style="${session.umsg.jstype=='C'?'':'display: none'}">
                            <div class="col-lg-4 col-md-6 col-sm-8">
                                <label class="col-auto col-form-label" style="padding-right:1px;padding-left:10px;">其他要求</label>
                                <textarea class="form-control" style="resize: none;" rows="3" id="t43" name="t43"></textarea>
                            </div>
                        </div>
                        <div class="row col-auto" th:style="${session.umsg.jstype=='C'?'':'display: none'}">
                            <div class="col-lg-4 col-md-8 col-sm-10">
                                <label for="up" class="col-auto col-form-label" style="padding-right:1px;padding-left:10px;">场地照片</label>
                                <input type="file" class="form-control" id="up" name="up" value="/home/images/logo.png" onchange="showpdtpgs('up','#p1')" multiple/>
                            </div>
                        </div>
                        <div class="row" th:style="${session.umsg.jstype=='C'?'':'display: none'}">
                            <div class="col-md-10 col-sm-11">
                                <div id="p1" style="display: flex;justify-content: start;align-items: center;flex-flow: row wrap;padding: 20px;"></div>
                            </div>
                        </div>
                        <div class="xqbox" style="min-height:580px;display: none">
                            <div class="row">
                                <div class="col-md-5">
                                    <div class="form-group">
                                        <label class="layui-form-label">课程名称：</label>
                                        <span class="jspan" id="x1">2.0</span>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-5">
                                    <div class="form-group">
                                        <label class="layui-form-label">授课方：</label>
                                        <span class="jspan" id="x2">2.0</span>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-5">
                                    <div class="form-group">
                                        <label class="layui-form-label">联系电话：</label>
                                        <span class="jspan" id="x3">2.0</span>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-5">
                                    <div class="form-group">
                                        <label class="layui-form-label">适合年龄：</label>
                                        <span class="jspan" id="x4">2.0</span>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-5">
                                    <div class="form-group">
                                        <label class="layui-form-label">人数建议：</label>
                                        <span class="jspan" id="x5">2.0</span>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-5">
                                    <div class="form-group">
                                        <label class="layui-form-label">课时总长：</label>
                                        <span class="jspan" id="x6">2.0</span>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-5">
                                    <div class="form-group">
                                        <label class="layui-form-label">送教地域限制：</label>
                                        <span class="jspan" id="x7">2.0</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer" style="height:100px;">
                        <button type="submit" class="btn btn-primary" id="edit-four1">提交</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="modal fade fadeMask" id="modal-event" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog" style="max-width: 800px;">
        <div class="modal-content">
            <div class="modal-header">
                <h6 class="modal-title">选择上课日期</h6>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="closecbt()"></button>
            </div>
            <div class="modal-body">
                <div id="calendar" data-provide="fullcalendar"></div>
            </div>
            <div class="modal-footer">
                <span style="width:60px;position: absolute;left:10px;">预约日期</span>
                <span id="yydate" style="width:120px;position: absolute;left:80px;"></span>
                <button onclick="closecbt()" type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="okcbt()">确认</button>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/popper.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<!-- 数字动态滚动增加效果 -->
<script type="text/javascript" src="js/scroll-numbers.js"></script>
<!--引入chart插件js-->
<script type="text/javascript" src="js/main.min.js"></script>
<script type="text/javascript" src="js/perfect-scrollbar.min.js"></script>
<script type="text/javascript" src="js/bootstrap-multitabs/multitabs.min.js"></script>
<script type="text/javascript" src="js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="js/index.min.js"></script>
<!--tags插件-->
<script type="text/javascript" src="js/jquery-tagsinput/jquery.tagsinput.min.js"></script>
<!--上传插件-->
<script type="text/javascript" src="js/webuploader/webuploader.js"></script>
<!--灯箱效果插件-->
<script type="text/javascript" src="js/magnific-popup/magnific-popup.min.js"></script>
<!--通知消息插件-->
<script type="text/javascript" src="js/bootstrap-notify.min.js"></script>
<!--引入标签插件js-->
<script type="text/javascript" src="js/jquery-confirm/jquery-confirm.min.js"></script>
<script type="text/javascript" src="js/main.min.js"></script>
<!--引入下拉插件js-->
<script type="text/javascript" src="js/bootstrap-select/bootstrap-select.min.js"></script>
<script type="text/javascript" src="js/bootstrap-select/i18n/defaults-zh_CN.min.js"></script>
<script type="text/javascript" src="js/layer/layer.js"></script>
<script type="text/javascript" src="js/layui/layui.js"></script>
<!-- 表格JS -->
<script type="text/javascript" src="static/tables/datatables.min.js"></script>
<script type="text/javascript" src="static/tables/dataTables.buttons.min.js"></script>
<script type="text/javascript" src="static/tables/jszip.min.js"></script>
<script type="text/javascript" src="static/tables/pdfmake.min.js"></script>
<script type="text/javascript" src="static/tables/vfs_fonts.js"></script>
<script type="text/javascript" src="static/tables/buttons.html5.min.js"></script>
<script type="text/javascript" src="static/tables/buttons.print.min.js"></script>
<script type="text/javascript" src="static/tables/datatable.js"></script>
<!-- 翻页-->
<script type="text/javascript" src="pagejs/htfy.js"></script>
<!-- validate JS 验证-->
<script type="text/javascript" src="assets/jquery-validate/jquery.validate.js"></script>
<script type="text/javascript" src="assets/jquery-validate/validate-methods.js"></script>

<!--日期选择器js-->
<script type="text/javascript" src="js/bootstrap-datepicker/bootstrap-datepicker.min.js"></script>
<script type="text/javascript" src="js/bootstrap-datepicker/locales/bootstrap-datepicker.zh-CN.min.js"></script>
<!--时间日期选择器js-->
<script type="text/javascript" src="js/momentjs/moment.min.js"></script>
<script type="text/javascript" src="js/bootstrap-datetimepicker/bootstrap-datetimepicker.min.js"></script>
<script type="text/javascript" src="js/momentjs/locale/zh-cn.min.js"></script>
<!--日程插件-->
<script type="text/javascript" src="js/fullcalendar/core/main.min.js"></script>
<script type="text/javascript" src="js/fullcalendar/core/locales/zh-cn.js"></script>
<script type="text/javascript" src="js/fullcalendar/interaction/main.min.js"></script>
<script type="text/javascript" src="js/fullcalendar/daygrid/main.min.js"></script>
<script type="text/javascript" src="js/fullcalendar/timegrid/main.min.js"></script>
<script type="text/javascript" src="js/fullcalendar/list/main.min.js"></script>
<script type="text/javascript" src="js/fullcalendar/rrule/main.min.js"></script>

</body>
</html>
<!--图片-->
<script type="text/javascript">

    var imglist=[];
    var t4=[];
    //判断图片
    function showpdtpgs(id,img){
        var file = document.getElementById(id).files;
        if((imglist.length+file.length)>3){
            layer.msg("最多上传3张图片");
            return false;
        }else{
            if(file){
                for(var i=0;i<file.length;i++){
                    imglist.push(file[i]);
                }
                insertImg(img);
            }
        }
    }

    //删除图片
    function imgRemove(obj){
        let indexp = obj.getAttribute("id").replace("DP","");
        if(obj.getAttribute("name").indexOf("upload/")>=0){
            // $("#delimg").val($("#delimg").val()+"#"+(obj.getAttribute("name")).replace("upload/shopimg/",""));
            $("#delimg").val($("#delimg").val()+"#"+(obj.getAttribute("name")).replace("upload/",""));
            $("#delid").val($("#delid").val()+"#"+(obj.getAttribute("tid")));
        }
        imglist.splice(indexp,1);
        insertImg("#p1");
    }

    function insertImg(img){
        $(img).empty();
        var html="";
        for(var i=0;i<imglist.length;i++){
            var data = imglist[i];
            if(typeof(imglist[i])=="object"){
                t4.push(imglist[i])
                var reader = new FileReader();
                reader.readAsDataURL(imglist[i]);
                reader.onload = (function(i,e) {
                    let data1 = e.target.result;
                    const image = new Image()
                    image.src = e.target.result
                    return new Promise((resolve) => {
                        image.onload = () => {
                            // const width = image.width
                            // const height = image.height
                            // console.log(width+"---"+height)
                            // if(width==414&&height==280){
                            html="<div class='item' style='margin-right: 20px;position: relative;'>";
                            html+="<img src='"+data1+"' style='width:200px;' />";
                            html+="<button class='btn btn-link imgTem' id=\'DP"+i+"\'  tid='' name=''' onclick='imgRemove(this)'>X</button>";
                            html+="</div>";
                            $(img).append(html);
                            // }else{
                            //     layer.open({content: '分辨率必须是414*280',btn: '我知道了'});
                            // }
                        }
                    })
                }).bind(reader, i);
            }else{
                html="<div class='item' style='margin-right: 20px;position: relative;'>";
                html+="<img src='"+data.split("#")[1]+"' style='width:200px;' />";
                html+="<button class='btn btn-link imgTem' id=\'DP"+i+"\'  tid=\'"+data.split("#")[0]+"\' name=\'"+data.split("#")[1]+"\'  onclick='imgRemove(this)'>X</button>";
                html+="</div>";
                $(img).append(html);
            }
        }
    }

    var imglist1=[];
    var w2=[];

    var imglist2=[];
    var w3=[];

    var imglistt3=[];
    var w4=[];

    //删除图片
    function imgRemove1(obj,type){
        let indexp = obj.getAttribute("id").replace(type,"");
        indexp = indexp.replace("P","");
        //后台删除图片
        if(obj.getAttribute("name").indexOf("upload/")>=0){
            // $("#delimg").val($("#delimg").val()+"#"+(obj.getAttribute("name")).replace("upload/shopimg/",""));
            $("#delimg").val($("#delimg").val()+"#"+(obj.getAttribute("name")).replace("upload/",""));
            $("#delid").val($("#delid").val()+"#"+(obj.getAttribute("tid")));
        }
        // if(obj.getAttribute("name").indexOf("https://fxtgoss.oss-cn-hangzhou.aliyuncs.com/shopimg/")>=0){
        //     // $("#delimg").val($("#delimg").val()+"#"+(obj.getAttribute("name")).replace("https://fxtgoss.oss-cn-hangzhou.aliyuncs.com/shopimg/",""));
        //     $("#delimg").val($("#delimg").val()+"#"+(obj.getAttribute("name")).replace("https://fxtgoss.oss-cn-hangzhou.aliyuncs.com/shopimg/",""));
        // }
        // console.log(imglist1)
        // console.log(imglist2)
        // console.log(imglist3)
        if(type=="A"){
            imglist1.splice(indexp,1);
            insertImg1("#p2",type);
        }else if(type=="B"){
            imglist2.splice(indexp,1);
            insertImg1("#p3",type);
        }else if(type=="C"){
            imglist3.splice(indexp,1);
            insertImg1("#p4",type);
        }
    }

    //判断图片
    function showpdtpgs1(id,img,zt){
        var file = document.getElementById(id).files;
        let pd =true;
        if(zt=="C"){
            if(file){
                for(var i=0;i<file.length;i++){
                    var imagSize =file[i].size;
                    let index=i;
                    let fileName = file[i].name; // 获取文件名
                    file_lastName = fileName.split('.').pop(); // 获取后缀名
                    filesize = file[i].size/(1024*1024);
                    if(file_lastName!="mp4"){
                        showNotify('文件类型不正确，只允许上传后缀名为：mp4，请重新上传！', 'danger', 1500);
                        $("#w4").val("");
                    }else if(filesize>100){
                        showNotify('文件不得超过100M，请重新上传！', 'danger', 1500);
                        $("#w4").val("");
                    }else{
                        var reader = new FileReader();
                        if(index==(file.length-1)){
                            if(pd){
                                for(var j=0;j<file.length;j++){
                                    if(id=="w2")imglist1.push(file[j]);
                                    if(id=="w3")imglist2.push(file[j]);
                                    if(id=="w4")imglist3.push(file[j]);
                                }
                                insertImg1(img,id=="w2"?'A':(id=="w3"?'B':'C'));
                            }
                        }
                    }
                }
            }
        }else{
            if(file){
                for(var i=0;i<file.length;i++){
                    var imagSize =file[i].size;
                    let index=i;
                    if(imagSize <= 1024 * 1024 * 2){
                        var reader = new FileReader();
                        reader.readAsDataURL(file[i]);
                        reader.onload = (function(i,e) {
                            const image = new Image()
                            image.src = e.target.result
                            return new Promise((resolve) => {
                                image.onload = () => {
                                    const width = image.width
                                    const height = image.height
                                    if(width>=800||height>=800){
                                        pd =false;
                                        layui.use('layer', function(){
                                            var layer = layui.layer;
                                            layer.ready(function(){
                                                layer.msg('分辨率不超过800px');
                                            });
                                        });
                                    }
                                    if(index==(file.length-1)){
                                        if(pd){
                                            for(var j=0;j<file.length;j++){
                                                if(zt=="A")imglist1.push(file[j]);
                                                if(zt=="B")imglist2.push(file[j]);
                                            }
                                            insertImg1(img,zt);
                                        }
                                    }
                                }
                            })
                        }).bind(reader, i);
                    }else{
                        pd =false;
                        $(img).val("");
                        layui.use('layer', function(){
                            var layer = layui.layer;
                            layer.ready(function(){
                                layer.msg("图片大小在2M以内");
                            });
                        });
                    }
                }
            }
        }

    }

    function insertImg1(img,zt){
        // console.log(imglist1)
        // console.log(imglist2)
        // console.log(imglist3)
        $(img).empty();
        var html="";
        if(zt=="A"){
            w2=[];
            for(var i=0;i<imglist1.length;i++){
                html="";
                var data = imglist1[i];
                if(typeof(imglist1[i])=="object"){
                    let data1 ="";
                    w2.push(imglist1[i])
                    console.log(w2)
                    var reader = new FileReader();
                    reader.readAsDataURL(imglist1[i]);
                    reader.onload = (function(i,e) {
                        data1 = e.target.result;
                        const image = new Image()
                        image.src = e.target.result
                        return new Promise((resolve) => {
                            image.onload = () => {
                                // const width = image.width
                                // const height = image.height
                                // if(width==414&&height==280){
                                html="<div class='item' style='margin-right: 20px;position: relative;'>";
                                html+="<img src='"+data1+"' style='width:200px;' />";
                                html+="<button class='btn btn-link imgTem' id=\'AP"+i+"\' tid='' name='' onclick='imgRemove1(this,\""+zt+"\")'>X</button>";
                                html+="</div>";
                                $(img).append(html);
                                // }else{
                                //     layer.open({content: '分辨率必须是414*280',btn: '我知道了'});
                                // }
                            }
                        })
                    }).bind(reader, i);
                }else{
                    html="<div class='item' style='margin-right: 20px;position: relative;'>";
                    html+="<img src='"+data.split("#")[1]+"' style='width:200px;' />";
                    html+="<button class='btn btn-link imgTem' id=\'AP"+i+"\' tid=\'"+data.split("#")[0]+"\' name=\'"+data.split("#")[1]+"\' onclick=\'imgRemove1(this,\""+zt+"\")\'>X</button>";
                    html+="</div>";
                    $(img).append(html);
                }
            }
        }else if(zt=="B"){
            w3=[];
            for(var i=0;i<imglist2.length;i++){
                html="";
                var data = imglist2[i];
                if(typeof(imglist2[i])=="object"){
                    let data1 ="";
                    w3.push(imglist2[i])
                    var reader = new FileReader();
                    reader.readAsDataURL(imglist2[i]);
                    reader.onload = (function(i,e) {
                        data1 = e.target.result;
                        const image = new Image()
                        image.src = e.target.result
                        return new Promise((resolve) => {
                            image.onload = () => {
                                // const width = image.width
                                // const height = image.height
                                // if(width==414&&height==280){
                                html="<div class='item' style='margin-right: 20px;position: relative;'>";
                                html+="<img src='"+data1+"' style='width:200px;' />";
                                html+="<button class='btn btn-link imgTem' id=\'BP"+i+"\' tid='' name='' onclick='imgRemove1(this,\""+zt+"\")'>X</button>";
                                html+="</div>";
                                $(img).append(html);
                                // }else{
                                //     layer.open({content: '分辨率必须是414*280',btn: '我知道了'});
                                // }
                            }
                        })
                    }).bind(reader, i);
                }else{
                    html="<div class='item' style='margin-right: 20px;position: relative;'>";
                    html+="<img src='"+data.split("#")[1]+"' style='width:200px;' />";
                    html+="<button class='btn btn-link imgTem' id=\'BP"+i+"\' tid=\'"+data.split("#")[0]+"\' name=\'"+data.split("#")[1]+"\' onclick='imgRemove1(this,\""+zt+"\")'>X</button>";
                    html+="</div>";
                    $(img).append(html);
                }
            }
        }else if(zt=="C"){
            w4=[];
            for(var i=0;i<imglist3.length;i++){
                html="";
                var data = imglist3[i];
                if(typeof(imglist3[i])=="object"){
                    let data1 ="";
                    w4.push(imglist3[i])
                    var file = imglist3[i]; // 获取文件对象
                    if (file) {
                        let fileName = file.name; // 获取文件名
                        file_lastName = fileName.split('.').pop(); // 获取后缀名
                        filesize = file.size/(1024*1024);
                        if(file_lastName!="mp4"){
                            showNotify('文件类型不正确，只允许上传后缀名为：mp4，请重新上传！', 'danger', 1500);
                            $("#w4").val("");
                        }else if(filesize>100){
                            showNotify('文件不得超过100M，请重新上传！', 'danger', 1500);
                            $("#w4").val("");
                        }else{
                            var reader = new FileReader();
                            reader.onload = function(e) {
                                data1=e.target.result;
                                html="<div class='item' style='margin-right: 20px;position: relative;'>";
                                html+="<video src='"+data1+"' style='width:200px;z-index:10;' ></video>";
                                html+="<button class='btn btn-link imgTem' style='z-index:20;' id=\'CP"+i+"\' tid='' name='' onclick='imgRemove1(this,\""+zt+"\")'>X</button>";
                                html+="</div>";
                                $(img).append(html);
                            };
                            reader.readAsDataURL(file);
                        }
                    }
                }else{
                    html="<div class='item' style='margin-right: 20px;position: relative;'>";
                    html+="<video src='"+data.split("#")[1]+"' style='width:200px;z-index:10;' ></video>";
                    html+="<button class='btn btn-link imgTem' style='z-index:20;' id=\'CP"+i+"\' tid=\'"+data.split("#")[0]+"\' name=\'"+data.split("#")[1]+"\' onclick='imgRemove1(this,\""+zt+"\")'>X</button>";
                    html+="</div>";
                    $(img).append(html);
                }
            }
        }
    }
</script>

<script type="text/javascript">

    var file_lastName="";
    var filesize;
    var layer = layui.layer;
    var load_index;
    var kcid;
    var arr=[];

    function tole(){
        var params = [
            ["fh",$("#fhlx").val()]
        ];
        form_submit("toHt/tolevel","post",params,"_self");
    }

    function toxk(){
        var params = [
            ["fh",$("#fhlx").val()]
        ];
        form_submit("toHt/tochose","post",params,"_self");
    }

    pdyes($("#pages").val(), $("#counts").val());
    //翻页
    function usefanye(pageindex){
        var params = [
            ["pages",pageindex],["flid",$.trim($("#flid").val())],["ztype",$.trim($("#ztype").val())],["fzt",$.trim($("#fzt").val())],
            ["skid",$.trim($("#skid").val())],["xkid",$.trim($("#xkid").val())]];
        form_submit("toHt/toselection","post",params,"_self");
    }

    function todc(){
        var params = [
            ["type","DC"],
            ["pages",$("#pages").val()],
            ["flid",$.trim($("#flid").val())],["ztype",$.trim($("#ztype").val())],["fzt",$.trim($("#fzt").val())],
            ["skid",$.trim($("#skid").val())],["xkid",$.trim($("#xkid").val())]];
        form_submit("toHt/toselection","post",params,"_blank");
    }

    function del(id,uname){
        if (confirm("您确定删除吗?")) {
            load_index = layer.load(1);
            var formData = new FormData();
            formData.append("fid",id);
            formData.append("uname",uname);
            $.ajax({
                url: 'toHt/delselection', // 服务器端处理上传文件的URL
                type: 'POST',
                data: formData,
                dataType:'json',
                contentType: false, // 不设置内容类型
                processData: false, // 不处理发送的数据
                success: function (res) {
                    var d = eval(res);
                    if(d.msg=="0"){
                        layer.msg("删除成功");
                        setTimeout(function(){
                            location.reload();
                        },1000);
                    }
                    layer.close(load_index);
                },
                error: function () { console.log('提交失败'); }
            });
        }
    }
    //刷新页面
    function pagerefalsh(){
        location.reload();
    }
    function gobackpage(){
        window.history.back();
    }

    function tobh(obj,zt){
        let item = null;
        if(obj.indexOf("Hash")>0){
            item = striongTOjsonString(obj);
        }else{
            item = jsStringTojsonString(obj);
        }

        $("#xqmode").find(".modal-body").empty();
        let html="";
        if(zt=="A"){
            html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
            html+= '<label class="layui-form-label">驳回原因：</label>';
            html+= '<span class="jspan">'+item.yhe030+'</span>';
            html+= '</div></div>';
        }else{
            html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
            html+= '<label class="layui-form-label">取消原因：</label>';
            html+= '<span class="jspan">'+item.yhe031+'</span>';
            html+= '</div></div>';
        }
        $("#xqmode").find(".modal-body").append(html);
    }

    function toxq(obj,ti1,i1,i2,i3,list,list1,list2,list3){
        let item = null;
        if(obj.indexOf("Hash")>0){
            item = striongTOjsonString(obj);
        }else{
            item = jsStringTojsonString(obj);
        }
        let item1 = null;
        if(i1.indexOf("Hash")>0){
            item1 = striongTOjsonString(i1);
        }else{
            item1 = jsStringTojsonString(i1);
        }
        let item2 = null;
        if(i2.indexOf("Hash")>0){
            item2 = striongTOjsonString(i2);
        }else{
            item2 = jsStringTojsonString(i2);
        }
        let item3 = null;
        if(i1.indexOf("Hash")>0){
            item3 = striongTOjsonString(i3);
        }else{
            item3 = jsStringTojsonString(i3);
        }
        list = list.substring(1,list.length-1);
        let listD1=list.split("cdyhf");
        let listD=[];
        for(var i=0;i<listD1.length;i++){
            if(listD1[i]!=""){
                listD1[i] = listD1[i].replaceAll("],","]");
                if (listD1[i].indexOf("Hash") > 0) {
                    listD.push(striongTOjsonString(listD1[i]));
                } else {
                    listD.push(jsStringTojsonString(listD1[i]));
                }
            }
        }
        list1 = list1.substring(1,list1.length-1);
        let listA1=list1.split("cdyhf");
        let listA=[];
        for(var i=0;i<listA1.length;i++){
            if(listA1[i]!=""){
                listA1[i] = listA1[i].replaceAll("],","]");
                if (listA1[i].indexOf("Hash") > 0) {
                    listA.push(striongTOjsonString(listA1[i]));
                } else {
                    listA.push(jsStringTojsonString(listA1[i]));
                }
            }
        }
        list2 = list2.substring(1,list2.length-1);
        let listB1=list2.split("cdyhf");
        let listB=[];
        for(var i=0;i<listB1.length;i++){
            if(listB1[i]!=""){
                listB1[i] = listB1[i].replaceAll("],","]");
                if (listB1[i].indexOf("Hash") > 0) {
                    listB.push(striongTOjsonString(listB1[i]));
                } else {
                    listB.push(jsStringTojsonString(listB1[i]));
                }
            }
        }
        list3 = list3.substring(1,list3.length-1);
        let listC1=list3.split("cdyhf");
        let listC=[];
        for(var i=0;i<listC1.length;i++){
            if(listC1[i]!=""){
                listC1[i] = listC1[i].replaceAll("],","]");
                if (listC1[i].indexOf("Hash") > 0) {
                    listC.push(striongTOjsonString(listC1[i]));
                } else {
                    listC.push(jsStringTojsonString(listC1[i]));
                }
            }
        }

        $("#xqmode").find(".modal-body").empty();
        let html="";
        html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
        html+= '<label class="layui-form-label">课程名称：</label>';
        html+= '<span class="jspan">'+item1.hba002+'</span>';
        html+= '</div>';
        html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
        html+= '<label class="layui-form-label">课程代码：</label>';
        html+= '<span class="jspan">'+item1.hba035+'</span>';
        html+= '</div>';
        html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
        html+= '<label class="layui-form-label">选课方名称：</label>';
        html+= '<span class="jspan">'+item2.yhb004+'</span>';
        html+= '</div>';
        html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
        html+= '<label class="layui-form-label">授课方名称：</label>';
        html+= '<span class="jspan">'+item3.smd003+'</span>';
        html+= '</div>';
        html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
        html+= '<label class="layui-form-label">授课地点：</label>';
        html+= '<span class="jspan">'+item.yhe009+'</span>';
        html+= '</div>';
        html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
        html+= '<label class="layui-form-label">活动日期：</label>';
        html+= '<span class="jspan">'+getTime(ti1,'YY-MM-DD')+item.yhe041+'</span>';
        html+= '</div>';
        html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
        html+= '<label class="layui-form-label">预约日期备注：</label>';
        html+= '<span class="jspan">'+item.yhe042+'</span>';
        html+= '</div>';
        html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
        html+= '<label class="layui-form-label">活动人数：</label>';
        html+= '<span class="jspan">'+item.yhe010+'</span>';
        html+= '</div>';
        html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
        html+= '<label class="layui-form-label">其他要求：</label>';
        html+= '<span class="jspan">'+item.yhe043+'</span>';
        html+= '</div>';
        if($("#jstype").val()=="C"){
            html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
            html+= '<label class="layui-form-label">联系人：</label>';
            html+= '<span class="jspan">'+(item1.hba016)+'</span>';
            html+= '</div>';
            html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
            html+= '<label class="layui-form-label">联系人电话：</label>';
            html+= '<span class="jspan">'+(item1.hba017)+'</span>';
            html+= '</div>';
        }else{
            html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
            html+= '<label class="layui-form-label">联系人：</label>';
            html+= '<span class="jspan">'+(item.yhe044!=null&&item.yhe044!=""?item.yhe044:item2.yhb006)+'</span>';
            html+= '</div>';
            html+= '<div class="row"><div class="form-group col-xl-3 col-md-4 col-sm-6">';
            html+= '<label class="layui-form-label">联系人电话：</label>';
            html+= '<span class="jspan">'+(item.yhe045!=null&&item.yhe045!=""?item.yhe045:item2.yhb007)+'</span>';
            html+= '</div>';
        }
        if(listD.length>0){
            html+= "<div class='row'><div class='form-group col-xl-3 col-md-5 col-sm-12'>";
            html+= "<label class='layui-form-label'>场地照片：</label>";
            for (let i=0;i<listD.length;i++){
                html+= "<img class='form-control' src='upload/"+listD[i].yhf005+"/"+listD[i].yhf004+"' style='width: 300px;'/>";
            }
            html+= "</div>";
        }
        if(listA.length>0){
            html+= "<div class='row'><div class='form-group col-xl-3 col-md-5 col-sm-12'>";
            html+= "<label class='layui-form-label'>签到：</label>";
            for (let i=0;i<listA.length;i++){
                html+= "<img class='form-control' src='upload/"+listA[i].yhf005+"/"+listA[i].yhf004+"' style='width: 300px;'/>";
            }
            html+= "</div>";
        }
        if(listB.length>0){
            html+= "<div class='row'><div class='form-group col-xl-3 col-md-5 col-sm-12'>";
            html+= "<label class='layui-form-label'>服务照片：</label>";
            for (let i=0;i<listB.length;i++){
                html+= "<img class='form-control' src='upload/"+listB[i].yhf005+"/"+listB[i].yhf004+"' style='width: 300px;'/>";
            }
            html+= "</div>";
        }
        if(listC.length>0){
            html+= "<div class='row'><div class='form-group col-xl-3 col-md-5 col-sm-12'>";
            html+= "<label class='layui-form-label'>服务视频：</label>";
            for (let i=0;i<listC.length;i++){
                html+= "<video class='form-control' src='upload/"+listC[i].yhf005+"/"+listC[i].yhf004+"' style='width: 300px;'></video>";
            }
            html+= "</div>";
        }
        $("#xqmode").find(".modal-body").append(html);
    }

    function xgzt(id,uname,type,lxr,lxfs){
        var flag=false;
        var num = null;
        var num1 = null;
        if(type=="C"||type=="D"||type=="S"||type=="T") {
            num = prompt("请输入驳回备注", "");
        }else{
            type=="G"||type=="H"?flag=confirm("您确定接受吗"):(type=="M"||type=="N"?flag=confirm("您确定取消预约吗"):flag=confirm("您确定同意取消预约吗?"));
        }
        if(flag&&(type=="M"||type=="N")){
            flag=confirm("您正在取消预约,请与"+lxr+lxfs+"联系")
            num1 = prompt("请输入取消备注", "");
        }
        if (num!=null||num1!=null||flag) {
            load_index = layer.load(1);
            var formData = new FormData();
            formData.append("fid",id);
            formData.append("uname",uname);
            formData.append("type",type);
            formData.append("t1",num);
            formData.append("t2",num1);
            $.ajax({
                url: 'toHt/xgztselection', // 服务器端处理上传文件的URL
                type: 'POST',
                data: formData,
                dataType:'json',
                contentType: false, // 不设置内容类型
                processData: false, // 不处理发送的数据
                success: function (res) {
                    var d = eval(res);
                    if(d.msg=="0"){
                        if(type=="C"||type=="D"||type=="S"||type=="T"){
                            layer.msg("驳回成功");
                        }else {
                            layer.msg("操作成功");
                        }
                        setTimeout(function(){
                            location.reload();
                        },1000);

                    }else if(d.msg=="S1"){
                        layer.msg("层级场次不足");
                    }else if(d.msg=="S2"){
                        layer.msg("选课方场次不足");
                    }else if(d.msg=="S3"){
                        layer.msg("授课方场次不足");
                    }
                    layer.close(load_index);
                },
                error: function () { console.log('提交失败'); }
            });
        }/*else{
            if(!confirm("您确定取消操作吗")){
                xgzt(id,uname,type);
            }
        }*/
    }
</script>
<!--日期-->
<script type="text/javascript">
    $(document).ready(function(){
        //上月监听
        $(".fc-prev-button").click(function(e){
            getpkjl();
        });
        //下月监听
        $(".fc-next-button").click(function(e){
            getpkjl();
        });
        $(".fc-today-button").click(function(e){
            getpkjl();
        });
    });
    function closecbt(){
        $("#yydate").empty();
    }
    function okcbt(){
        $("#t8").val($("#yydate").text());
        $("#yydate").empty();
        $("#modal-event").modal('hide');
    }
    //获取当月的排课记录的方法
    function getpkjl() {
        load_index = layer.load(1);
        var formData = new FormData();
        formData.append('kcid',kcid);
        formData.append('pkyear',formatDate(calendar.state.currentDate, 'yyyy'));
        formData.append('pkmonth',formatDate(calendar.state.currentDate, 'MM'));
        $.ajax({
            url: 'toHt/getcoursepk',
            type: 'POST',
            data: formData,
            async: false,                      //async 设置为 false，则所有的请求均为同步请求，在没有返回值之前，同步请求将锁住浏览器
            cache: false,                      // 不缓存
            processData: false,                // jQuery不要去处理发送的数据
            contentType: false,                // jQuery不要去设置Content-Type请求头
            dataType: 'json',
            success: function (res) {
                var d = eval(res);
                if(d.msg=="N"){
                    layer.msg('该月无排课记录！');
                    ispk = false;
                }else{
                    arr = [];
                    calendar.removeAllEventSources();
                    d = d.list;
                    for(var i=0;i<d.length;i++){
                        if(d[i].yhd004!="N") arr.push({id:d[i].yhd001,title:"上午",start:formatDate(d[i].yhd003, 'yyyy-MM-dd'),zt:(d[i].yhd004=="Y"?"N":"Y")});
                        if(d[i].yhd005!="N") arr.push({id:d[i].yhd001,title:"下午",start:formatDate(d[i].yhd003, 'yyyy-MM-dd'),zt:(d[i].yhd005=="Y"?"N":"Y"),className: 'bg-purple'});
                        if(d[i].yhd006!="N") arr.push({id:d[i].yhd001,title:"晚上",start:formatDate(d[i].yhd003, 'yyyy-MM-dd'),zt:(d[i].yhd006=="Y"?"N":"Y"),className: 'bg-danger'});
                    }
                    calendar.addEventSource(arr);
                    calendar.refetchEvents();
                    ispk = true;
                }
                layer.close(load_index);
            },
            error: function () {
                layer.close(load_index);
            }
        });

    }

    var calendarEl = document.getElementById('calendar');

    // 定义时间点（避免时间变化导致示例不显示）
    var thisDate     = new Date();
    var thisFullYear = thisDate.getFullYear();
    var thisMonth    = thisDate .getMonth() + 1;
    if (thisMonth < 10) thisMonth = '0' + thisMonth;

    var calendar = new FullCalendar.Calendar(calendarEl, {
        plugins: [ 'interaction', 'dayGrid', 'timeGrid', 'list', 'rrule' ],
        height: 'auto',
        header: {
            left: '',
            center: 'title',
            right:'today,prev,next'
        },
        buttonText: {
            today:'今天',
            prev:'上月',
            next:'下月',
            prevYear:'上一年',
            nextYear:'下一年'
        },
        defaultView: 'dayGridMonth',
        editable: true, // 确定是否可以修改日历上的事件。
        eventLimit: false, // 当事件太多时允许“更多”链接
        eventOrder:false,
        events: [],
        dateClick: function(date, jsEvent, view) {
        },
        eventClick: function(date, jsEvent, view) {
            check = formatDate(date.event.start, 'yyyy-MM-dd HH:mm:ss');
            today = formatDate(new Date(), 'yyyy-MM-dd');
            if (check < today) {
                // 这是一个过去的日期，取消选择或显示消息
                layer.msg('请预约今天及以后日期！');
            } else {
                // 这是一个有效的日期，执行你的逻辑
                var time_str = formatDate(date.event.start, 'yyyy-MM-dd');
                $("#yydate").empty();
                $("#yydate").text(time_str+" "+date.event.title);
            }
        }
    });

    calendar.render();
    calendar.setOption('locale', 'zh');

    // 时间格式化
    function formatDate(date = new Date(), fmt = 'yyyy-MM-dd HH:mm:ss') {
        date = (typeof date === 'number' || typeof date === 'string') ? new Date(date) : date;

        var o = {
            'M+': date.getMonth() + 1, // 月份
            'd+': date.getDate(), // 日
            'h+': date.getHours() % 12 === 0 ? 12 : date.getHours() % 12, // 小时
            'H+': date.getHours(), // 小时
            'm+': date.getMinutes(), // 分
            's+': date.getSeconds(), // 秒
            'q+': Math.floor((date.getMonth() + 3) / 3), // 季度
            'S': date.getMilliseconds() // 毫秒
        };
        var week = {
            '0': '\u65e5',
            '1': '\u4e00',
            '2': '\u4e8c',
            '3': '\u4e09',
            '4': '\u56db',
            '5': '\u4e94',
            '6': '\u516d'
        };

        if (/(y+)/.test(fmt)) {
            fmt = fmt.replace(RegExp.$1, (date.getFullYear() + '').substr(4 - RegExp.$1.length));
        }

        if (/(E+)/.test(fmt)) {
            fmt = fmt.replace(RegExp.$1, ((RegExp.$1.length > 1) ? (RegExp.$1.length > 2 ? '\u661f\u671f' : '\u5468') : '') + week[date.getDay() + '']);
        }

        for (var k in o) {
            if (new RegExp('(' + k + ')').test(fmt)) {
                fmt = fmt.replace(RegExp.$1, (RegExp.$1.length === 1) ? (o[k]) : (('00' + o[k]).substr(('' + o[k]).length)));
            }
        }

        return fmt;
    }
</script>
<!--预约-->
<script type="text/javascript">
    $('select[id=t9]').change(function() {
        toxgxk(this.value,"")
    });
    function toxgxk(id,kcid){
        $.ajax({
            url:'getallchose?flid='+id,
            type:'post',
            async: false,
            cache: false,
            processData: false,
            contentType: false,
            dataType:'json',
            success:function(data) {
                var list = eval(data.list);
                $('select[id=t3]').empty();
                $("select[id=t3]").append("<option value=''></option>");
                for(var i=0;i<list.length;i++){
                    $("select[id=t3]").append("<option value='"+list[i].yhb001+"'>"+list[i].yhb004+"</option>");
                    // if($("#t6").val()==""&&kcid==list[i].hba001)$("#t6").val($('#t4 option:selected').attr("x8"))
                }
                $('select[id=t3]').val(kcid);
                $('select[id=t3]').selectpicker('destroy');
                $('select[id=t3]').selectpicker('render');
            },
            error:function(){}
        });
    }
    $('select[id=t1]').change(function() {
        toxgkc(this.value,"")

    });
    function toxgkc(id,kcid){
        $.ajax({
            url:'getallcourse?flid='+id+'&jgid='+ ($("#jstype").val()=="B"?$('#skid').val():''),
            type:'post',
            async: false,
            cache: false,
            processData: false,
            contentType: false,
            dataType:'json',
            success:function(data) {
                var list = eval(data.list);
                $('select[id=t4]').empty();
                $("select[id=t4]").append("<option value=''></option>");
                for(var i=0;i<list.length;i++){
                    $("select[id=t4]").append("<option value='"+list[i].hba001+"' xname='"+list[i].smd.smd003+"'" +
                        " x1='"+list[i].hba002+"'  x3='"+list[i].hba017+"'  x4='"+list[i].hba003+"'  x5='"+list[i].hba008+"'  x9='"+list[i].hba009+"'  x6='"+list[i].hba005+"'  x7='"+list[i].hba015+"' x8='"+list[i].hba013+"' " +
                        ">"+list[i].hba002+"("+list[i].smd.smd003+")"+"</option>");
                    // if($("#t6").val()==""&&kcid==list[i].hba001)$("#t6").val($('#t4 option:selected').attr("x8"))
                }
                $('select[id=t4]').val(kcid);
                $('select[id=t4]').selectpicker('destroy');
                $('select[id=t4]').selectpicker('render');
                tokcxq()
            },
            error:function(){}
        });
    }

    function tokcxq(){
        if($('#t2').val()!=""&&$('#t14').val()!=""){
            // $('.xqbox').show()
            $('#x1').html($('#t4 option:selected').attr("x1"))
            $('#x2').html($('#t4 option:selected').attr("xname"))
            $('#x3').html($('#t4 option:selected').attr("x3"))
            $('#x4').html($('#t4 option:selected').attr("x4"))
            $('#x5').html($('#t4 option:selected').attr("x5")+" "+$('#t4 option:selected').attr("x9"))
            $('#x6').html($('#t4 option:selected').attr("x6"))
            $('#x7').html($('#t4 option:selected').attr("x7"))
        }
    }

    $('#t2').change(function() {
        tokcxq()
    })
    $('#t14').change(function() {
        tokcxq()
    })

    $('select[id=t4]').change(function() {
        $("#t8").empty();
        if(this.value!=""){
            $('#modal-event').modal('show');
            kcid = this.value;
            // if($("#t6").val()=="")$("#t6").val($('#t4 option:selected').attr("x8"))
            getpkjl();
            toxgls(this.value,"")
        }
    });
    function toxgls(id,lsid){
        $.ajax({
            url:'getallcoursels?fid='+id,
            type:'post',
            async: false,
            cache: false,
            processData: false,
            contentType: false,
            dataType:'json',
            success:function(data) {
                var list = eval(data.list);
                $("select[id=t11]").empty();
                $("select[id=t11]").append("<option value=''></option>");
                for(var i=0;i<list.length;i++){
                    $("select[id=t11]").append("<option value='"+list[i].yhc001+"'>"+list[i].yhc003+"</option>");
                }
                if(lsid!="null")$('select[id=t11]').val(lsid);
                $('select[id=t11]').selectpicker('destroy');
                $('select[id=t11]').selectpicker('render');
            },
            error:function(){}
        });
    }


    $("#uploadForm1").validate({
        errorPlacement: function(error, element) {
            //替换错误显示位置，error表示错误信息
            $(element).parent("div").parent("div").append(error);
            $(element).parent("div").parent("div").find("label").addClass("col-12");
            // $(element).parent("div").parent("div").find("label").attr("style","margin-left:5px;");
        },
        rules : {t3: { required : true, },t2: { required : $("#lx").val()=="C", },t4: { required : true, },t8: { required : true, },t14: { required : true, },t5: { required : true, },},
        messages: {},
        submitHandler: function(form) {
            load_index = layer.load(1);
            var formData = new FormData();
            formData.append("t3",$("#t3").val());
            formData.append("t2",$("#t2").val());
            formData.append("t4",$("#t4").val());
            formData.append("t8",$("#t8").val());
            formData.append("t6",$("#t6").val());
            formData.append("t14",$("#t14").val());
            formData.append("t45",$("#t45").val());
            formData.append("t42",$("#t42").val());
            formData.append("t43",$("#t43").val());
            formData.append("t44",$("#t44").val());
            formData.append("t11",$("#t11").val());
            formData.append("lx",$("#lx").val());
            formData.append("fid",$("#fid").val());

            formData.append("delimg",$("#delimg").val());
            formData.append("delid",$("#delid").val());
            formData.delete("s1");
            for(var i=0;i<t4.length;i++){
                formData.append("s1",t4[i]);
            }
            $.ajax({
                url: 'toHt/xgselection1', // 服务器端处理上传文件的URL
                type: 'POST',
                data: formData,
                dataType:'json',
                contentType: false, // 不设置内容类型
                processData: false, // 不处理发送的数据
                success: function (res) {
                    var d = eval(res);
                    layer.close(load_index);
                    console.log(d)
                    if(d.msg=="S1"){
                        layer.msg("层级场次不足");
                    }else if(d.msg=="S2"){
                        layer.msg("选课方场次不足");
                    }else if(d.msg=="S3"){
                        layer.msg("授课方场次不足");
                    }else{
                        $("#fid").val(d.d.yhe001);
                        layer.msg("提交成功");
                        var listD=d.list;
                        if(listD!=null){
                            var html1="";
                            $("#p1").empty();
                            imglist=[];
                            t4=[];
                            for(var i=0;i<listD.length;i++){
                                html1="";
                                data1="upload/"+listD[i].yhf005+"/"+listD[i].yhf004
                                imglist.push(listD[i].yhf001+"#"+data1);
                                html1="<div class='item' style='margin-right: 20px;position: relative;'>";
                                html1+="<img src='"+data1+"' style='width:200px;' />";
                                html1+="<button class='btn btn-link imgTem' id=\'DP"+i+"\'  tid=\'"+listD[i].yhf001+"\' tid=\'"+listD[i].yhf001+"\'  name=\'"+data1+"\'  onclick='imgRemove(this)'>X</button>";
                                html1+="</div>";
                                $("#p1").append(html1);
                            }
                        }
                    }
                },
                error: function () { console.log('提交失败'); }
            });

        }
    });



</script>
<!--编辑-->
<script type="text/javascript">
    function edit(obj,flid,flid1,t1,list){
        if(obj!=null&&obj!=''){
            imglist=[];
            t4=[];
            let josnobj = null;
            if(obj.indexOf("Hash")>0){
                josnobj = striongTOjsonString(obj);
            }else{
                josnobj = jsStringTojsonString(obj);
            }
            list = list.substring(1,list.length-1);
            let listD1=list.split("cdyhf");
            let listD=[];
            for(var i=0;i<listD1.length;i++){
                if(listD1[i]!=""){
                    listD1[i] = listD1[i].replaceAll("],","]");
                    if (listD1[i].indexOf("Hash") > 0) {
                        listD.push(striongTOjsonString(listD1[i]));
                    } else {
                        listD.push(jsStringTojsonString(listD1[i]));
                    }
                }
            }
            $("#tname").val(name);
            $("#fid").val(josnobj.yhe001);
            $("#t6").val(josnobj.yhe015);
            $("#t9").val(flid1);
            toxgxk(flid1,josnobj.yhe002)
            $('select[id=t9]').selectpicker('destroy');
            $('select[id=t9]').selectpicker('render');
            $("#t1").val(flid);
            toxgkc(flid,josnobj.yhe004)
            toxgls(josnobj.yhe004,josnobj.yhe005)
            kcid = josnobj.yhe004;
            getpkjl();
            $("#t8").val(getTime(t1,'YY-MM-DD')+" "+josnobj.yhe041);
            $("#t2").val(josnobj.yhe009);
            $("#t14").val(josnobj.yhe010);
            $("#t42").val(josnobj.yhe042);
            $("#t43").val(josnobj.yhe043);
            $("#t44").val(josnobj.yhe044);
            $("#t45").val(josnobj.yhe045);
            if(listD!=null){
                var html1="";
                $("#p1").empty();
                for(var i=0;i<listD.length;i++){
                    html1="";
                    data1="upload/"+listD[i].yhf005+"/"+listD[i].yhf004
                    imglist.push(listD[i].yhf001+"#"+data1);
                    html1="<div class='item' style='margin-right: 20px;position: relative;'>";
                    html1+="<img src='"+data1+"' style='width:200px;' />";
                    html1+="<button class='btn btn-link imgTem' id=\'DP"+i+"\'  tid=\'"+listD[i].yhf001+"\' tid=\'"+listD[i].yhf001+"\'  name=\'"+data1+"\'  onclick='imgRemove(this)'>X</button>";
                    html1+="</div>";
                    $("#p1").append(html1);
                }
            }
            $("#ftype").text("编辑");
        }else{
            $("#ftype").text("添加");
        }
    }
</script>
<!--评价-->
<script type="text/javascript">
    function topj(obj,time1,list1,list2,list3) {
        if (obj != null && obj != '') {
            imglist1=[];
            w2=[];
            imglis2=[];
            w3=[];
            imglist3=[];
            w4=[];
            let josnobj = null;
            if (obj.indexOf("Hash") > 0) {
                josnobj = striongTOjsonString(obj);
            } else {
                josnobj = jsStringTojsonString(obj);
            }
            list1 = list1.substring(1,list1.length-1);
            let listA1=list1.split("cdyhf");
            let listA=[];
            let iA=null;
            for(var i=0;i<listA1.length;i++){
                if(listA1[i]!=""){
                    listA1[i] = listA1[i].replaceAll("],","]");
                    if (listA1[i].indexOf("Hash") > 0) {
                        iA=striongTOjsonString(listA1[i]);
                        
                        if(iA.yhf006==$("#lx").val())listA.push(iA);
                    }
                }
            }
            list2 = list2.substring(1,list2.length-1);
            let listB1=list2.split("cdyhf");
            let listB=[];
            for(var i=0;i<listB1.length;i++){
                if(listB1[i]!=""){
                    listB1[i] = listB1[i].replaceAll("],","]");
                    if (listB1[i].indexOf("Hash") > 0) {
                        iA=striongTOjsonString(listB1[i])
                        if(iA.yhf006==$("#lx").val())listB.push(iA);
                    }
                }
            }
            list3 = list3.substring(1,list3.length-1);
            let listC1=list3.split("cdyhf");
            let listC=[];
            for(var i=0;i<listC1.length;i++){
                if(listC1[i]!=""){
                    listC1[i] = listC1[i].replaceAll("],","]");
                    if (listC1[i].indexOf("Hash") > 0) {
                        iA=striongTOjsonString(listC1[i])
                        if(iA.yhf006==$("#lx").val())listC.push(iA);
                    }
                }
            }
            $("#fid").val(josnobj.yhe001);
            $("#xkid1").val(josnobj.yhe002);
            // $("#tname").val(name);
            $("#zt").val(josnobj.yhe007);
            if($("#lx").val()=="C") {
                $("input[name='p1']").each(function(){
                    if($(this).val()==josnobj.yhe021){
                        $(this).prop("checked",true);
                    }else{
                        $(this).prop("checked",false);
                    }
                });
                $("input[name='p2']").each(function(){
                    if($(this).val()==josnobj.yhe022){
                        $(this).prop("checked",true);
                    }else{
                        $(this).prop("checked",false);
                    }
                });
                $("input[name='p3']").each(function(){
                    if($(this).val()==josnobj.yhe023){
                        $(this).prop("checked",true);
                    }else{
                        $(this).prop("checked",false);
                    }
                });
                $("input[name='p4']").each(function(){
                    if($(this).val()==josnobj.yhe024){
                        $(this).prop("checked",true);
                    }else{
                        $(this).prop("checked",false);
                    }
                });
                $("input[name='p5']").each(function(){
                    if($(this).val()==josnobj.yhe025){
                        $(this).prop("checked",true);
                    }else{
                        $(this).prop("checked",false);
                    }
                });
                $("input[name='p6']").each(function(){
                    if($(this).val()==josnobj.yhe026){
                        $(this).prop("checked",true);
                    }else{
                        $(this).prop("checked",false);
                    }
                });
                $("input[name='p7']").each(function(){
                    if($(this).val()==josnobj.yhe027){
                        $(this).prop("checked",true);
                    }else{
                        $(this).prop("checked",false);
                    }
                });
                $("input[name='p8']").each(function(){
                    if($(this).val()==josnobj.yhe028){
                        $(this).prop("checked",true);
                    }else{
                        $(this).prop("checked",false);
                    }
                });
                if(josnobj.yhe029!="null")$("#p9").val(josnobj.yhe029)
                $("#p17").val(josnobj.yhe016)
                console.log(time1)
                $("#p19").val(getTime(time1,'YY-MM-DD'));
            }
            else {
                $("input[name='p10']").each(function () {
                    if ($(this).val() == josnobj.yhe033) {
                        $(this).prop("checked", true);
                    } else {
                        $(this).prop("checked", false);
                    }
                });
                $("input[name='p11']").each(function () {
                    if ($(this).val() == josnobj.yhe034) {
                        $(this).prop("checked", true);
                    } else {
                        $(this).prop("checked", false);
                    }
                });
                $("input[name='p12']").each(function () {
                    if ($(this).val() == josnobj.yhe035) {
                        $(this).prop("checked", true);
                    } else {
                        $(this).prop("checked", false);
                    }
                });
                $("input[name='p13']").each(function () {
                    if ($(this).val() == josnobj.yhe036) {
                        $(this).prop("checked", true);
                    } else {
                        $(this).prop("checked", false);
                    }
                });
                $("input[name='p14']").each(function () {
                    if ($(this).val() == josnobj.yhe037) {
                        $(this).prop("checked", true);
                    } else {
                        $(this).prop("checked", false);
                    }
                });
                $("input[name='p15']").each(function () {
                    if ($(this).val() == josnobj.yhe038) {
                        $(this).prop("checked", true);
                    } else {
                        $(this).prop("checked", false);
                    }
                });
                $("#p18").val(josnobj.yhe017)
                if(josnobj.yhe039!="null")$("#p16").val(josnobj.yhe039)
            }
            var data1="";
            var html="";
            if(listA!=null){
                for(var i=0;i<listA.length;i++){
                    html="";
                    if(listA[i].yhf006==$("#lx").val()){
                        data1="upload/"+listA[i].yhf005+"/"+listA[i].yhf004
                        imglist1.push(listA[i].yhf001+"#"+data1);
                        html="<div class='item' style='margin-right: 20px;position: relative;'>";
                        html+="<img src='"+data1+"' style='width:200px;'/>";
                        html+="<div class='btn btn-link imgTem' id=\'P"+i+"\'  tid=\'"+listA[i].yhf001+"\'  name=\'"+data1+"\' onclick=\'imgRemove1(this,\"A\")\'>X</div>";
                        html+="</div>";
                        $("#p2").append(html);
                    }

                }
            }
            if(listB!=null){
                for(var i=0;i<listB.length;i++){
                    html="";
                    if(listB[i].yhf006==$("#lx").val()){
                        data1="upload/"+listB[i].yhf005+"/"+listB[i].yhf004
                        imglist2.push(listB[i].yhf001+"#"+data1);
                        html="<div class='item' style='margin-right: 20px;position: relative;'>";
                        html+="<img src='"+data1+"' style='width:200px;'/>";
                        html+="<div class='btn btn-link imgTem' id=\'P"+i+"\' tid=\'"+listB[i].yhf001+"\' name=\'"+data1+"\' onclick=\'imgRemove1(this,\"B\")\'>X</div>";
                        html+="</div>";
                        $("#p3").append(html);
                    }
                }
            }
            if(listC!=null){
                for(var i=0;i<listC.length;i++){
                    html="";
                    if(listC[i].yhf006==$("#lx").val()){
                        data1="upload/"+listC[i].yhf005+"/"+listC[i].yhf004
                        imglist3.push(listC[i].yhf001+"#"+data1);
                        html ="<div class='item' style='margin-right: 20px;position: relative;'>";
                        html +="<video src='"+data1+"' style='width:200px;'></video>";
                        html +="<div class='btn btn-link imgTem' id=\'P"+i+"\' tid=\'"+listC[i].yhf001+"\'  name=\'"+data1+"\' onclick=\'imgRemove1(this,\"C\")\'>X</div>";
                        html +="</div>";
                        $("#p4").append(html);
                    }
                }
            }
            $("#ftype2").text("编辑");
        }else{
            $("#ftype2").text("添加");
        }
    }

    $("#uploadForm2").validate({
        errorPlacement: function(error, element) {
            //替换错误显示位置，error表示错误信息
            $(element).parent("div").parent("div").append(error);
            $(element).parent("div").parent("div").find("label").addClass("col-12");
            // $(element).parent("div").parent("div").find("label").attr("style","margin-left:5px;");
        },
        rules : {p17: { required : $("#lx").val()=="C", },p1: { required : $("#lx").val()=="C", },p2: { required : $("#lx").val()=="C", },p3: { required : $("#lx").val()=="C", },p4: { required : $("#lx").val()=="C", },p5: { required : $("#lx").val()=="C", },p6: { required : $("#lx").val()=="C", },p7: { required : $("#lx").val()=="C", },p8: { required : $("#lx").val()=="C", },
            p18: { required : $("#lx").val()=="B", },p10: { required : $("#lx").val()=="B", },p11: { required : $("#lx").val()=="B", },p12: { required : $("#lx").val()=="B", },p13: { required : $("#lx").val()=="B", },p14: { required : $("#lx").val()=="B", },p15: { required : $("#lx").val()=="B", },},
        messages: {},
        submitHandler: function(form) {
            load_index = layer.load(1);
            var formData = new FormData();
            formData.append("fid",$("#fid").val().trim());
            formData.append("xkid1",$("#xkid1").val().trim());
            formData.append("p1",$("input[name='p1']:checked").val());
            formData.append("p2",$("input[name='p2']:checked").val());
            formData.append("p3",$("input[name='p3']:checked").val());
            formData.append("p4",$("input[name='p4']:checked").val());
            formData.append("p5",$("input[name='p5']:checked").val());
            formData.append("p6",$("input[name='p6']:checked").val());
            formData.append("p7",$("input[name='p7']:checked").val());
            formData.append("p8",$("input[name='p8']:checked").val());
            formData.append("p18",$("#p18").val());
            formData.append("p9",$("#p9").val());
            formData.append("p10",$("input[name='p10']:checked").val());
            formData.append("p11",$("input[name='p11']:checked").val());
            formData.append("p12",$("input[name='p12']:checked").val());
            formData.append("p13",$("input[name='p13']:checked").val());
            formData.append("p14",$("input[name='p14']:checked").val());
            formData.append("p15",$("input[name='p15']:checked").val());
            formData.append("p16",$("#p16").val());
            formData.append("p19",$("#p19").val());
            formData.append("p17",$("#p17").val());
            formData.append("t1",$("#tname").val());
            formData.append("lx",$("#lx").val());
            formData.append("zt",$("#zt").val());
            formData.append("delimg",$("#delimg").val());
            formData.append("delid",$("#delid").val());
            formData.delete("w2");
            console.log(w2)
            for(var i=0;i<w2.length;i++){
                formData.append("w2",w2[i]);
            }
            formData.delete("w3");
            for(var i=0;i<w3.length;i++){
                formData.append("w3",w3[i]);
            }
            formData.delete("w4");
            for(var i=0;i<w4.length;i++){
                formData.append("w4",w4[i]);
            }
            $.ajax({
                url: 'toHt/xgselection2', // 服务器端处理上传文件的URL
                type: 'POST',
                data: formData,
                dataType:'json',
                contentType: false, // 不设置内容类型
                processData: false, // 不处理发送的数据
                success: function (res) {
                    var d = eval(res);
                    $("#delimg").val("");
                    $("#delid").val("");
                    $("#fid").val(d.d.yhe001);

                    var html1="";
                    var data1="";
                    imglist1=[];
                    w2=[];
                    imglist2=[];
                    w3=[];
                    imglist3=[];
                    w4=[];
                    var listA=d.listA;
                    if(listA!=null){
                        $("#p2").empty();
                        for(var i=0;i<listA.length;i++){
                            html1="";
                            if(listA[i].yhf006==$("#lx").val()){
                                data1="upload/"+listA[i].yhf005+"/"+listA[i].yhf004
                                imglist1.push(listA[i].yhf001+"#"+data1);
                                html1="<div class='item' style='margin-right: 20px;position: relative;'>";
                                html1+="<img src='"+data1+"' style='width:200px;' />";
                                html1+="<button class='btn btn-link imgTem' id=\'AP"+i+"\'  tid=\'"+listA[i].yhf001+"\' tid=\'"+listA[i].yhf001+"\'  name=\'"+data1+"\'  onclick='imgRemove(this,\"A\")'>X</button>";
                                html1+="</div>";
                                $("#p2").append(html1);
                            }

                        }
                    }
                    var listB=d.listB;
                    if(listB!=null){
                        $("#p3").empty();
                        for(var i=0;i<listB.length;i++){
                            html1="";
                            if(listB[i].yhf006==$("#lx").val()){
                                data1="upload/"+listB[i].yhf005+"/"+listB[i].yhf004
                                imglist2.push(listB[i].yhf001+"#"+data1);
                                html1="<div class='item' style='margin-right: 20px;position: relative;'>";
                                html1+="<img src='"+data1+"' style='width:200px;' />";
                                html1+="<button class='btn btn-link imgTem' id=\'BP"+i+"\'  tid=\'"+listB[i].yhf001+"\' tid=\'"+listB[i].yhf001+"\'  name=\'"+data1+"\'  onclick='imgRemove1(this,\"B\")'>X</button>";
                                html1+="</div>";
                                $("#p3").append(html1);
                            }
                        }
                    }
                    var listC=d.listC;
                    if(listC!=null){
                        $("#p4").empty();
                        for(var i=0;i<listC.length;i++){
                            html1="";
                            if(listC[i].yhf006==$("#lx").val()){
                                data1="upload/"+listC[i].yhf005+"/"+listC[i].yhf004
                                imglist3.push(listC[i].yhf001+"#"+data1);
                                html1 ="<div class='item' style='margin-right: 20px;position: relative;'>";
                                html1 +="<video src='"+data1+"' style='width:200px;' ></video>";
                                html1 +="<button class='btn btn-link imgTem' id=\'CP"+i+"\'  tid=\'"+listC[i].yhf001+"\' tid=\'"+listC[i].yhf001+"\'  name=\'"+data1+"\'  onclick='imgRemove1(this,\"C\")'>X</button>";
                                html1 +="</div>";
                                $("#p4").append(html1);
                            }
                        }
                    }
                    // console.log(imglist1)
                    // console.log(imglist2)
                    // console.log(imglist3)
                    layer.close(load_index);
                    layer.msg("提交成功");

                },
                error: function () { console.log('提交失败'); }
            });

        }
    });
</script>
