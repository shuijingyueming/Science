<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <base th:href="${#request.getContextPath()}+'/'">
    <title>后台管理系统</title>
    <meta http-equiv="pragma" content="no-cache"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" type="image/x-icon" href="images/favicon.ico">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="stylesheet" type="text/css" href="css/materialdesignicons.min.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="js/bootstrap-multitabs/multitabs.min.css">
    <link type="text/css" rel="stylesheet" href="js/jquery-tagsinput/jquery.tagsinput.min.css">
    <link type="text/css" rel="stylesheet" href="js/webuploader/webuploader.css">
    <link type="text/css" rel="stylesheet" href="js/magnific-popup/magnific-popup.min.css">
    <link rel="stylesheet" type="text/css" href="css/animate.min.css">
    <link rel="stylesheet" type="text/css" href="css/style.min.css">
    <link rel="stylesheet" type="text/css" href="css/page.css">
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="col-lg-12">
            <div class="card">
                <header class="card-header"><div class="card-title">[[${item.smd014=='E'?'您的申请已被驳回：'+item.smd015:(item.smd014=='P'?'已提交申请，请等待审核':(item.smd014=='M'?'通过':''))}]]</div></header>
                <div class="card-body">
                    <form id="uploadForm" enctype="multipart/form-data">
                        <input type="hidden" id="fid" th:value="${item.smd001}" />
                        <div class="modal-body">
                            <div class="row">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">身份类别</label>
                                <div class="col-auto">
                                    <input class="form-check-input" id="r31" name="t3" value="A" type="radio" th:checked="${item.smd002=='A'?true:false}" >
                                    <label for="r32" class="form-check-label" style="padding-right:20px;">机构</label>
                                    <input  class="form-check-input" id="r32" name="t3" value="B" type="radio" th:checked="${item.smd002=='B'?true:false}">
                                    <label for="r32" class="form-check-label" style="padding-right:20px;">个人</label>
                                    <input class="form-check-input" id="r33" name="t3" value="C" type="radio" th:checked="${item.smd002=='C'?true:false}">
                                    <label for="r33" class="form-check-label" style="padding-right:20px;">专家</label>
                                </div>
                            </div>
                            <div class="row" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;" id="x1">机构</label>
                                <div class="col-xl-4 col-md-8 col-sm-12">
                                    <input type="text" class="form-control" id="t2" name="t2"  th:value="${item.smd003}"  placeholder="请输入机构名称"/>
                                </div>
                            </div>
                            <div class="row" style="margin-top: 20px;">
                                <div class="row col-xl-6 col-md-7 col-sm-6 col-12">
                                    <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;" id="x2">营业执照</label>
                                    <div class="col-xl-8 col-md-7 col-sm-12">
                                        <input type="text" class="form-control" id="t4" name="t4" th:value="${item.smd004}" placeholder="请输入营业执照"/>
                                    </div>
                                </div>
                            </div>
                            <div class="row" style="margin-top: 20px;">
                                <div class="row col-xl-4 col-md-5 col-sm-4">
                                    <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;">开户行</label>
                                    <div class="col-xl-7 col-md-8 col-sm-12">
                                        <input type="text" class="form-control" id="t5" name="t5"th:value="${item.smd005}"  placeholder="请输入开户行"/>
                                    </div>
                                </div>
                                <div class="row col-xl-4 col-md-5 col-sm-4 col-12">
                                    <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;" id="x3">账号</label>
                                    <div class="col-xl-7 col-md-7 col-sm-12">
                                        <input type="text" class="form-control" id="t7" name="t7"th:value="${item.smd007}"  placeholder="请输入账号"/>
                                    </div>
                                </div>
                            </div>
                            <div class="row col-xl-7 col-md-7 col-sm-8" style="margin-top: 20px;">
                                <label class="col-auto col-form-label" style="padding-right:20px;padding-left:20px;" id="x4">户名</label>
                                <div class="col-xl-7 col-md-8 col-sm-12">
                                    <input type="text" class="form-control" id="t6" name="t6"th:value="${item.smd006}"  placeholder="请输入户名"/>
                                </div>
                            </div>
                            <div class="row" style="margin-top: 20px;">
                                <div class="row col-xl-3 col-md-4 col-sm-4 col-12">
                                    <label class="col-auto col-form-label" >年场次数</label>
                                    <div class="col-xl-8 col-md-8 col-sm-8">
                                        <input type="number" class="form-control " id="t9" name="t9" th:value="${item.smd009}" placeholder="请输入年度场次限数" disabled="false" />
                                    </div>
                                </div>
                                <div class="row col-xl-3 col-md-4 col-sm-4 col-12">
                                    <label class="col-auto col-form-label" >年人次数</label>
                                    <div class="col-xl-8 col-md-8 col-sm-8">
                                        <input type="number" class="form-control" id="t10" name="t10" th:value="${item.smd010}" placeholder="请输入年度人次限数" disabled="false" />
                                    </div>
                                </div>
                                <!-- <div class="row col-xl-3 col-md-4 col-sm-4 col-12">
                                     <label class="col-auto col-form-label" >上线日期</label>
                                     <div class="col-xl-8 col-md-8 col-sm-8">
                                         <input type="date" class="form-control" id="t8" name="t8" th:value="${#dates.format(item.smd008,'yyyy-MM-dd')}" placeholder="请输入上线日期" disabled="false" />
                                     </div>
                                 </div>-->
                            </div>
                            <div class="row col-xl-4 col-md-6 col-sm-12 col-12" style="margin-top: 20px;">
                                <input id="tt24" name="tt24" th:value="${item.smd016}"  type="hidden">
                                <label for="t24" class="col-auto form-label">营业执照</label>
                                <div class="col-xl-8 col-md-8 col-sm-6 col-6">
                                    <input class="form-control" type="file" id="t24" onchange="showpdtpgs()">
                                    <!--onclick="$('#t24').click()"-->
                                    <image th:src="${'upload/yyzz/'+item.smd016}" id="shtp" class="form-control"
                                         style="width:280px;border:none;"/>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer" style="height:100px;" th:if="${item.smd014!='P'}">
                            <button type="submit" class="btn btn-primary" id="edit-four">提交</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/popper.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<!-- 数字动态滚动增加效果 -->
<script type="text/javascript" src="js/scroll-numbers.js"></script>
<!--引入chart插件js-->
<script type="text/javascript" src="js/main.min.js"></script>
<script type="text/javascript" src="js/perfect-scrollbar.min.js"></script>
<script type="text/javascript" src="js/bootstrap-multitabs/multitabs.min.js"></script>
<script type="text/javascript" src="js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="js/index.min.js"></script>
<!-- 表格JS -->
<script type="text/javascript" src="static/tables/datatables.min.js"></script>
<script type="text/javascript" src="static/tables/dataTables.buttons.min.js"></script>
<script type="text/javascript" src="static/tables/jszip.min.js"></script>
<script type="text/javascript" src="static/tables/pdfmake.min.js"></script>
<script type="text/javascript" src="static/tables/vfs_fonts.js"></script>
<script type="text/javascript" src="static/tables/buttons.html5.min.js"></script>
<script type="text/javascript" src="static/tables/buttons.print.min.js"></script>
<script type="text/javascript" src="static/tables/datatable.js"></script>
<!--tags插件-->
<script type="text/javascript" src="js/jquery-tagsinput/jquery.tagsinput.min.js"></script>
<!--上传插件-->
<script type="text/javascript" src="js/webuploader/webuploader.js"></script>
<!--灯箱效果插件-->
<script type="text/javascript" src="js/magnific-popup/magnific-popup.min.js"></script>
<!--通知消息插件-->
<script type="text/javascript" src="js/bootstrap-notify.min.js"></script>
<!--引入标签插件js-->
<script type="text/javascript" src="js/jquery-confirm/jquery-confirm.min.js"></script>
<script type="text/javascript" src="js/main.min.js"></script>
<!--引入下拉插件js-->
<script type="text/javascript" src="js/bootstrap-select/bootstrap-select.min.js"></script>
<script type="text/javascript" src="js/bootstrap-select/i18n/defaults-zh_CN.min.js"></script>
<script type="text/javascript" src="js/layer/layer.js"></script>
<script type="text/javascript" src="js/layui/layui.js"></script>
<!-- validate JS 验证-->
<script type="text/javascript" src="assets/jquery-validate/jquery.validate.js"></script>
<script type="text/javascript" src="assets/jquery-validate/validate-methods.js"></script>
<script type="text/javascript">

    var layer = layui.layer;
    var file_lastName = "";
    var load_index;
    $("input[name='t3']").click(function(){
            if($(this).val()=="A"){
                $("#x1").html("机构");
                $("#t2").attr("placeholder","请输入机构");
                $("#x2").html("营业执照");
                $("#t4").attr("placeholder","请输入营业执照");
                $("#x3").html("账号");
                $("#t7").attr("placeholder","请输入账号");
                $("#x4").html("户名");
                $("#t6").attr("placeholder","请输入户名");
            }else{
                $("#x1").html("个人名称");
                $("#t2").attr("placeholder","请输入个人名称");
                $("#x2").html("身份证号");
                $("#t4").attr("placeholder","请输入身份证号");
                $("#x3").html("姓名");
                $("#t7").attr("placeholder","请输入姓名");
                $("#x4").html("银行卡号");
                $("#t6").attr("placeholder","请输入银行卡号");
            }
    });

    $("#uploadForm").validate({
        errorPlacement: function(error, element) {
            //替换错误显示位置，error表示错误信息
            $(element).parent("div").parent("div").append(error);
            $(element).parent("div").parent("div").find("label").addClass("col-12");
            // $(element).parent("div").parent("div").find("label").attr("style","margin-left:5px;");
        },
        rules : {t2: { required : true, },t4: { required : true, },t5: { required : true, },},
        messages: {},
        submitHandler: function(form) {
            load_index = layer.load(1);
            var formData = new FormData();
            formData.append("fid",$("#fid").val().trim());
            formData.append("t2",$("input[name='t3']:checked").val());
            formData.append("t3",$("#t2").val());
            formData.append("t4",$("#t4").val());
            formData.append("t5",$("#t5").val());
            formData.append("t6",$("#t6").val());
            formData.append("t7",$("#t7").val());
            /*formData.append("t8",$("#t8").val());*/
            formData.append("t9",$("#t9").val());
            formData.append("t10",$("#t10").val());
            formData.append("tt24", $("#tt24").val());
            formData.append("t24", document.getElementById("t24").files[0]);
            formData.append("zt","X");
            $.ajax({
                url: 'toHt/xgselect', // 服务器端处理上传文件的URL
                type: 'POST',
                data: formData,
                dataType:'json',
                contentType: false, // 不设置内容类型
                processData: false, // 不处理发送的数据
                success: function (res) {
                    var d = eval(res.d);
                    $("#fid").val(d.smd001);
                    layer.close(load_index);
                    layer.msg("提交成功");
                },
                error: function () { console.log('提交失败'); }
            });

        }
    });

    //判断图片
    function showpdtpgs(){
        var filePath = ['.jpg','.jpeg','.png'];
        var file = document.getElementById("t24").files[0];
        if(file){
            var filename = file.name;
            var filejw = filename.substring(filename.lastIndexOf("."));
            var pd = false;
            for(var i=0;i<filePath.length;i++){
                if(filejw==filePath[i]){
                    var reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = function(e) {
                        var data = e.target.result;
                        $("#shtp").attr("src",data);
                    };
                    pd =  true;
                    return;
                }
            }
            if(!pd){
                file.value="";
                $("#file").val("");
                layer.msg("只能上传以.jpg、.jpeg、.png结尾的图片");
                return;
            }
        }else{
            if($("#id").val()==""){
                $("#shtp").attr("src","");
            }
        }
    }
</script>
</body>
</html>